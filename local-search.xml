<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>LangChain4jå®è·µ</title>
    <link href="/2025/08/23/LangChain4j%E5%AE%9E%E8%B7%B5/"/>
    <url>/2025/08/23/LangChain4j%E5%AE%9E%E8%B7%B5/</url>
    
    <content type="html"><![CDATA[<h1 id="å¤§æ¨¡å‹è°ƒç”¨"><a href="#å¤§æ¨¡å‹è°ƒç”¨" class="headerlink" title="å¤§æ¨¡å‹è°ƒç”¨"></a>å¤§æ¨¡å‹è°ƒç”¨</h1><h2 id="è¯·æ±‚ä¸å“åº”"><a href="#è¯·æ±‚ä¸å“åº”" class="headerlink" title="è¯·æ±‚ä¸å“åº”"></a>è¯·æ±‚ä¸å“åº”</h2><p>categories: LLM<br>æ¡ˆä¾‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs cpp">curl -X POST https:<span class="hljs-comment">//dashscope.aliyuncs.com/compatible-mode/v1/chat/completions \</span><br><span class="hljs-comment">-H &quot;Authorization: Bearer $DASHSCOPE_API_KEY&quot; \</span><br><span class="hljs-comment">-H &quot;Content-Type: application/json&quot; \</span><br><span class="hljs-comment">-d &#x27;&#123;</span><br>    <span class="hljs-string">&quot;model&quot;</span>: <span class="hljs-string">&quot;qwen-plus&quot;</span>,<br>    <span class="hljs-string">&quot;messages&quot;</span>: [<br>        &#123;<br>            <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;system&quot;</span>,<br>            <span class="hljs-string">&quot;content&quot;</span>: <span class="hljs-string">&quot;ä½ æ˜¯ä¸€ä¸ªå¼€å‘ç»éªŒä¸°å¯Œçš„ç¨‹åºå‘˜ï¼Œè¯·ä»¥æ­¤è§’è‰²è¿›è¡Œæ²Ÿé€š&quot;</span><br>        &#125;,<br>        &#123;<br><br>            <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;user&quot;</span>, <br>            <span class="hljs-string">&quot;content&quot;</span>: <span class="hljs-string">&quot;ä½ æ˜¯è°ï¼Ÿ&quot;</span><br>        &#125;<br>    ],<br>    <span class="hljs-string">&quot;stream&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-string">&quot;enable_search&quot;</span>: <span class="hljs-literal">false</span><br>&#125;<br>&#x27;<br></code></pre></td></tr></table></figure><ul><li><p>æ ¸å¿ƒè¯·æ±‚å‚æ•°ï¼š</p><p><strong>model</strong>ï¼šæŒ‡å®šè°ƒç”¨æ¨¡å‹çš„åç§°  </p><p><strong>messages</strong>: ä¼ é€’ç»™å¤§æ¨¡å‹çš„æ¶ˆæ¯ï¼Œå…¶ä¸­roleä¸ºè§’è‰²ï¼Œæœ‰ä¸‰ç§<strong>user&#x2F;system&#x2F;assistant</strong>ã€‚systemè¡¨ç¤ºæ¨¡å‹çš„ç›®æ ‡æˆ–è§’è‰²ã€‚å¦‚æœè®¾ç½®ç³»ç»Ÿæ¶ˆæ¯ï¼Œè¯·æ”¾åœ¨messagesåˆ—è¡¨çš„ç¬¬ä¸€ä½ï¼›assistantè¡¨ç¤ºæ¨¡å‹å¯¹ç”¨æˆ·æ¶ˆæ¯çš„å›å¤</p><p><strong>stream</strong>ï¼šè¡¨ç¤ºæ˜¯å¦æµå¼è¾“å‡ºå›å¤ï¼Œé»˜è®¤ä¸ºflaseï¼Œè¡¨ç¤ºæ¨¡å‹ç”Ÿæˆå®Œæ‰€æœ‰å†…å®¹åä¸€æ¬¡æ€§è¿”å›ç»“æœã€‚trueï¼šè¾¹ç”Ÿæˆè¾¹è¾“å‡ºï¼Œå³æ¯ç”Ÿæˆä¸€éƒ¨åˆ†å†…å®¹å°±ç«‹å³è¾“å‡ºä¸€ä¸ªç‰‡æ®µï¼ˆchunkï¼‰ã€‚æ‚¨éœ€è¦å®æ—¶åœ°é€ä¸ªè¯»å–è¿™äº›ç‰‡æ®µä»¥è·å¾—å®Œæ•´çš„ç»“æœ</p><p><strong>enable_search</strong>ï¼šæ¨¡å‹åœ¨ç”Ÿæˆæ–‡æœ¬æ—¶æ˜¯å¦ä½¿ç”¨äº’è”ç½‘æœç´¢ç»“æœè¿›è¡Œå‚è€ƒï¼Œé»˜è®¤ä¸ºfalse</p></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;choices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;assistant&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æˆ‘æ˜¯ä½ çš„æŠ€æœ¯ä¼™ä¼´ï¼Œä¸€ä¸ªæ‹¥æœ‰å¤šå¹´å¼€å‘ç»éªŒçš„ç¨‹åºå‘˜ï¼Œç†Ÿæ‚‰å„ç§ç¼–ç¨‹è¯­è¨€å’Œå¼€å‘æ¡†æ¶ã€‚æ— è®ºæ˜¯åç«¯å¼€å‘ã€å‰ç«¯è®¾è®¡ã€æ•°æ®åº“ä¼˜åŒ–ï¼Œè¿˜æ˜¯ç³»ç»Ÿæ¶æ„è®¾è®¡ï¼Œæˆ‘éƒ½èƒ½ä¸ºä½ æä¾›ä¸“ä¸šçš„å»ºè®®å’Œæ”¯æŒã€‚æœ‰ä»€ä¹ˆæŠ€æœ¯é—®é¢˜æˆ–é¡¹ç›®éœ€æ±‚ï¼Œå°½ç®¡å‘Šè¯‰æˆ‘ï¼&quot;</span><br>            <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;finish_reason&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;stop&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;index&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;logprobs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;object&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;chat.completion&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;usage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;prompt_tokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">31</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;completion_tokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">55</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;total_tokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">86</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;prompt_tokens_details&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;cached_tokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;created&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1755954402</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;system_fingerprint&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;model&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;qwen-plus&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;chatcmpl-18f38aea-6193-9efe-95c3-57e0458b618a&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><ul><li><p>æ ¸å¿ƒå“åº”å‚æ•°:</p><p><strong>choices</strong>ï¼šæ¨¡å‹ç”Ÿæˆçš„å†…å®¹æ•°ç»„ï¼Œå¯ä»¥åŒ…å«ä¸€æ¡æˆ–å¤šæ¡å†…å®¹</p><ul><li>messageï¼šæœ¬æ¬¡è°ƒç”¨æ¨¡å‹è¾“å‡ºçš„æ¶ˆæ¯</li><li>finish_reasonï¼šstopè¡¨ç¤ºè‡ªç„¶ç»“æŸï¼Œlengthè¡¨ç¤ºç”Ÿæˆå†…å®¹è¿‡é•¿</li><li>indexï¼šå½“å‰å†…å®¹åœ¨choicesæ•°ç»„ä¸­çš„ç´¢å¼•</li></ul><p>objectï¼šå§‹ç»ˆä¸ºchat.completionï¼Œæ— éœ€å…³æ³¨</p><p><strong>usage</strong>ï¼šæœ¬æ¬¡å¯¹è¯è¿‡ç¨‹ä¸­ä½¿ç”¨çš„tokenä¿¡æ¯</p><ul><li>prompt_tokensï¼šç”¨æˆ·çš„è¾“å…¥è½¬æ¢æˆtokençš„ä¸ªæ•°</li><li>completion_tokensï¼šæ¨¡å‹ç”Ÿæˆçš„å›å¤è½¬æ¢æˆtokençš„ä¸ªæ•°</li><li>total_tokensï¼šç”¨æˆ·è¾“å…¥å’Œæ¨¡å‹ç”Ÿæˆçš„æ€»tokenä¸ªæ•°</li></ul><p>createdï¼šæœ¬æ¬¡ä¼šè¯è¢«åˆ›å»ºçš„æ—¶é—´æˆ³</p><p>system_fingerprintï¼šå›ºå®šä¸ºnullï¼Œæ— éœ€å…³æ³¨</p><p>modelï¼šæœ¬æ¬¡ä¼šè¯ä½¿ç”¨çš„æ¨¡å‹</p><p>idï¼šæœ¬æ¬¡è°ƒç”¨çš„å”¯ä¸€æ ‡è¯†ç¬¦</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>LLM</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>MyBatis-Pluså­¦ä¹ è®°å½•</title>
    <link href="/2025/08/21/MyBatis-Plus%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    <url>/2025/08/21/MyBatis-Plus%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å®˜æ–¹æ–‡æ¡£é“¾æ¥ğŸ”—ï¼š<a href="https://baomidou.com/introduce/">MyBatis-Plus å¸®åŠ©æ–‡æ¡£</a></p></blockquote><h1 id="å¿«é€Ÿå…¥é—¨"><a href="#å¿«é€Ÿå…¥é—¨" class="headerlink" title="å¿«é€Ÿå…¥é—¨"></a>å¿«é€Ÿå…¥é—¨</h1><h2 id="å…¥é—¨æ¡ˆä¾‹"><a href="#å…¥é—¨æ¡ˆä¾‹" class="headerlink" title="å…¥é—¨æ¡ˆä¾‹"></a>å…¥é—¨æ¡ˆä¾‹</h2><ol><li>å¼•å…¥ä¾èµ–</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.12<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><ol start="2"><li>å®šä¹‰Mapperç»§æ‰¿MyBatis-Plusæä¾›çš„BaseMapperæ¥å£ï¼Œ<strong>æŒ‡å®šæ³›å‹ä¸ºæ“ä½œçš„å®ä½“ç±»</strong></li></ol><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-symbol">UserMapper</span> <span class="hljs-symbol">extends</span> <span class="hljs-symbol">BaseMapper</span>&lt;<span class="hljs-symbol">User</span>&gt;&#123;&#125;<br></code></pre></td></tr></table></figure><h2 id="å¸¸è§æ³¨è§£"><a href="#å¸¸è§æ³¨è§£" class="headerlink" title="å¸¸è§æ³¨è§£"></a>å¸¸è§æ³¨è§£</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼š</p><ul><li>ä»¥ç±»åé©¼å³°è½¬ä¸‹åˆ’çº¿ä½œä¸ºè¡¨å</li><li>æŠŠåä¸ºidçš„å­—æ®µä½œä¸ºä¸»é”®</li><li>å°†å˜é‡åé©¼å³°è½¬ä¸‹åˆ’çº¿ä½œä¸ºè¡¨çš„å­—æ®µå</li></ul><p>ä¸ç¬¦åˆé»˜è®¤è§„å®šæ—¶å€™ï¼Œå¯ç”¨æ³¨è§£å£°æ˜ï¼Œå¸¸ç”¨æ³¨è§£ä¸ºï¼š</p><ol><li><p><strong>@TableName</strong>ï¼šç”¨æ¥æŒ‡å®šæ“ä½œè¡¨æ˜</p></li><li><p><strong>@TableId</strong>ï¼šç”¨æ¥æŒ‡å®šè¡¨ä¸­çš„ä¸»é”®å­—æ®µä¿¡æ¯</p><ol><li>IdTypeæšä¸¾ï¼šAUTOæ•°æ®åº“è‡ªå¢é•¿,INPUTé€šè¿‡setè‡ªè¡Œè¾“å…¥,ASSIGN_IDåˆ†é…IDï¼Œç”±MPç”Ÿæˆid</li></ol></li><li><p><strong>@TableField</strong>ï¼šç”¨æ¥æŒ‡å®šè¡¨ä¸­çš„æ™®é€šå­—æ®µä¿¡æ¯ï¼Œä½¿ç”¨åœºæ™¯å¦‚ä¸‹</p><ol><li>æˆå‘˜å˜é‡åä¸æ•°æ®åº“å­—æ®µåä¸ä¸€è‡´æ—¶</li><li>æˆå‘˜å˜é‡åä»¥iså¼€å¤´ï¼Œä¸”æ˜¯å¸ƒå°”å€¼   eg. boolean isMarried</li><li>æˆå‘˜å˜é‡åä¸æ•°æ®åº“å…³é”®å­—å†²çª  eg. long order</li><li>æˆå‘˜å˜é‡ä¸æ˜¯æ•°æ®åº“å­—æ®µæ—¶</li></ol></li></ol><h1 id="æ ¸å¿ƒåŠŸèƒ½"><a href="#æ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="æ ¸å¿ƒåŠŸèƒ½"></a>æ ¸å¿ƒåŠŸèƒ½</h1><h2 id="æ¡ä»¶æ„é€ å™¨-Wrapper"><a href="#æ¡ä»¶æ„é€ å™¨-Wrapper" class="headerlink" title="æ¡ä»¶æ„é€ å™¨ Wrapper"></a>æ¡ä»¶æ„é€ å™¨ Wrapper</h2><p><strong>æ¡ˆä¾‹1</strong>ï¼šæŸ¥è¯¢åå­—å¸¦oï¼Œå­˜æ¬¾å¤§äºç­‰äº1000çš„äººçš„idï¼Œusernameï¼Œinfoï¼Œbalanceå­—æ®µ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> id,username,info,balance <span class="hljs-keyword">from</span> tb_user <span class="hljs-keyword">where</span> username <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%o%&#x27;</span> <span class="hljs-keyword">and</span> balance <span class="hljs-operator">&gt;=</span> <span class="hljs-number">1000</span><br></code></pre></td></tr></table></figure><p>åˆ©ç”¨MyBatis-Plusçš„QueryWrapperå®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ„å»ºæŸ¥è¯¢æ¡ä»¶</span><br>QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryWrapper</span>&lt;User&gt;()<br>        .select(<span class="hljs-string">&quot;id&quot;</span>,<span class="hljs-string">&quot;username&quot;</span>,<span class="hljs-string">&quot;info&quot;</span>,<span class="hljs-string">&quot;balance&quot;</span>)<br>        .like(<span class="hljs-string">&quot;username&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>).ge(<span class="hljs-string">&quot;balance&quot;</span>,<span class="hljs-number">1000</span>)<br><span class="hljs-comment">// æŸ¥è¯¢</span><br>List&lt;User&gt; users = userMapper.selectList(wrapper)<br></code></pre></td></tr></table></figure><p><strong>æ¡ˆä¾‹2</strong>ï¼šæ›´æ–°ç”¨æˆ·åä¸ºjackçš„ç”¨æˆ·çš„æœˆä¸º2000</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">update</span> tb_user <span class="hljs-keyword">set</span> balance <span class="hljs-operator">=</span> <span class="hljs-number">2000</span> <span class="hljs-keyword">where</span> username <span class="hljs-operator">=</span> jack<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨MyBatis-Plusçš„QueryWrapperå®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è¦æ›´æ–°çš„æ•°æ®</span><br><span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>user.setBalance(<span class="hljs-number">2000</span>);<br><br><span class="hljs-comment">// æ›´æ–°æ¡ä»¶</span><br>QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryWrapper</span>&lt;User&gt;().eq(<span class="hljs-string">&quot;username&quot;</span>,<span class="hljs-string">&quot;jack&quot;</span>)<br><br><span class="hljs-comment">// æ›´æ–°</span><br> userMapper.update(user, wrapper)<br></code></pre></td></tr></table></figure><p><strong>æ¡ˆä¾‹3</strong>ï¼šæ›´æ–°idä¸º1ï¼Œ2ï¼Œ4çš„ç”¨æˆ·ä½™é¢ï¼Œæ‰£200</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">update</span> tb_user <span class="hljs-keyword">set</span> balance <span class="hljs-operator">=</span> balance <span class="hljs-operator">-</span> <span class="hljs-number">200</span> <span class="hljs-keyword">where</span> id <span class="hljs-keyword">in</span> (<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>)<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨MyBatis-Plusçš„UpdateWrapperå®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;Long&gt; ids = List.of(<span class="hljs-number">1L</span>,<span class="hljs-number">2L</span>,<span class="hljs-number">4L</span>);<br><span class="hljs-comment">// æ›´æ–°æ¡ä»¶</span><br>UpdateWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UpdateWrapper</span>&lt;User&gt;()<br>        .setSql(<span class="hljs-string">&quot;balance = balance - 200&quot;</span>)<br>        .in(<span class="hljs-string">&quot;id&quot;</span>,ids);<br><span class="hljs-comment">// æ›´æ–°</span><br> userMapper.update(<span class="hljs-literal">null</span>, wrapper)<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨LambdaWrapperè¿›è¡Œæ”¹é€ ï¼Œé¿å…å­—ç¬¦ä¸²ç¡¬ç¼–ç  ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ„å»ºæŸ¥è¯¢æ¡ä»¶</span><br>LambdaQueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;User&gt;()<br>        .select(User::getId,User::getUsername,User::getInfo,User::getBalance)<br>        .like(User::getUsername,<span class="hljs-string">&quot;0&quot;</span>).ge(User::getBalance,<span class="hljs-number">1000</span>)<br><span class="hljs-comment">// æŸ¥è¯¢</span><br>List&lt;User&gt; users = userMapper.selectList(wrapper)<br></code></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰SQL"><a href="#è‡ªå®šä¹‰SQL" class="headerlink" title="è‡ªå®šä¹‰SQL"></a>è‡ªå®šä¹‰SQL</h2><p>ä¼ä¸šä¸­è¦æ±‚ä¸èƒ½åœ¨ä¸šåŠ¡å±‚ç¼–å†™SQLï¼Œä½†æƒ³ç®€åŒ–ç¼–ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Wrapperæ¥æ„å»ºå¤æ‚çš„whereæ¡ä»¶ï¼Œç„¶åè‡ªå®šä¹‰SQLè¯­å¥ä¸­å‰©ä¸‹éƒ¨åˆ†ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>åŸºäºWrapperæ„å»ºwhereæ¡ä»¶</li><li>åœ¨mapperæ–¹æ³•å‚æ•°ä¸­ç”¨Paramæ³¨è§£å£°æ˜Wrapperå˜é‡åç§°ï¼Œ<strong>å¿…é¡»æ˜¯ew</strong></li><li>è‡ªå®šä¹‰SQLï¼Œå¹¶ä½¿ç”¨Wrapperæ¡ä»¶</li></ol><p><strong>æ¡ˆä¾‹</strong>ï¼šæ›´æ–°idä¸º1ï¼Œ2ï¼Œ4çš„ç”¨æˆ·ä½™é¢ï¼Œæ‰£200</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 1. æ›´æ–°æ¡ä»¶</span><br>List&lt;Long&gt; ids = List.of(<span class="hljs-number">1L</span>,<span class="hljs-number">2L</span>,<span class="hljs-number">4L</span>);<br><span class="hljs-type">int</span> <span class="hljs-variable">amount</span> <span class="hljs-operator">=</span> <span class="hljs-number">200</span>;<br><span class="hljs-comment">// 2. å®šä¹‰æ¡ä»¶</span><br>QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryWrapper</span>&lt;User&gt;().in(<span class="hljs-string">&quot;id&quot;</span>,ids)<br><span class="hljs-comment">// 3. è°ƒç”¨è‡ªå®šä¹‰SQLæ–¹æ³•</span><br>userMapper.updateBalanceByIds(wrapper,amount)<br><br><span class="hljs-comment">//åˆ›å»ºæ–¹æ³•</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">updateBalanceByIds</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;ew&quot;)</span> QueryWrapper&lt;User&gt; wrapper,<span class="hljs-meta">@Param(&quot;amount&quot;)</span> <span class="hljs-type">int</span> amount)</span><br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- åœ¨UserMapper.xmlä¸­å®ŒæˆSQL --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateBlanceByIds&quot;</span>&gt;</span><br>    UPDATE tb_user SET balance = balance - #&#123;amount&#125; $&#123;ew.customSqlSegment&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="Serviceæ¥å£"><a href="#Serviceæ¥å£" class="headerlink" title="Serviceæ¥å£"></a>Serviceæ¥å£</h2><p>MPçš„Serviceæ¥å£å®ç°æµç¨‹ï¼š</p><ol><li>æˆ‘ä»¬çš„è‡ªå®šä¹‰æ¥å£éœ€è¦ç»§æ‰¿IServiceæ¥å£</li><li>æˆ‘ä»¬çš„å®ç°ç±»éœ€è¦å»ç»§æ‰¿ServiceImplå®ç°ç±»</li></ol><p>ç»§æ‰¿ç»“æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="/../images/MyBatis-Plus%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/1.png" alt="Serviceæ¥å£ç»§æ‰¿ç¤ºæ„å›¾"></p><h3 id="IServiceçš„LambdaæŸ¥è¯¢"><a href="#IServiceçš„LambdaæŸ¥è¯¢" class="headerlink" title="IServiceçš„LambdaæŸ¥è¯¢"></a>IServiceçš„LambdaæŸ¥è¯¢</h3><p><strong>æ¡ˆä¾‹</strong>ï¼šå®ç°ä¸€ä¸ªæ ¹æ®å¤æ‚æ¡ä»¶æŸ¥è¯¢ç”¨æˆ·çš„æ¥å£ï¼Œæ¡ä»¶å¦‚ä¸‹ï¼š</p><pre><code class="hljs">    - nameï¼šç”¨æˆ·åå…³é”®å­—ï¼Œå¯ä»¥ä¸ºç©º    - statusï¼šç”¨æˆ·çŠ¶æ€ï¼Œå¯ä»¥ä¸ºç©º    - minBalanceï¼šæœ€å°ä½™é¢ï¼Œå¯ä»¥ä¸ºç©º    - maxBalanceï¼šæœ€å¤§ä½™é¢ï¼Œå¯ä»¥ä¸ºç©º</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">queryUsers</span><span class="hljs-params">(String name, Integer status, Integer minBlance, Integer maxBalance)</span>&#123;<br>    <span class="hljs-keyword">return</span> lambdaQuery()<br>            .like(name != <span class="hljs-literal">null</span> ,User::getUsername, name)<br>            .eq(status != <span class="hljs-literal">null</span>,User::getStatus, status)<br>            .ge(minBlance != <span class="hljs-literal">null</span>,User::getMinBalance, maxBalance)<br>            .le(maxBalance != <span class="hljs-literal">null</span>,User::getMaxBalance, maxBalance)<br>            .list();<br>    &#125;<br></code></pre></td></tr></table></figure><h3 id="IServiceçš„æ‰¹å¤„ç†"><a href="#IServiceçš„æ‰¹å¤„ç†" class="headerlink" title="IServiceçš„æ‰¹å¤„ç†"></a>IServiceçš„æ‰¹å¤„ç†</h3><p>æ–¹æ¡ˆå¯¹æ¯”</p><ul><li><p>æ™®é€šforå¾ªç¯æ’å…¥æ–°å¢ç”¨æˆ·ï¼Œé€Ÿåº¦æå·®ï¼Œä¸æ¨è</p></li><li><p>MPçš„æ‰¹é‡æ–°å¢ï¼ŒåŸºäºé¢„ç¼–è¯‘çš„æ‰¹å¤„ç†ï¼Œæ€§èƒ½ä¸é”™</p></li><li><p>é…ç½®jdbcå‚æ•°ï¼Œå¼€å¯mysqlçš„rewriteBatchedStatements&#x3D;Trueå‚æ•°ï¼Œæ€§èƒ½æœ€å¥½</p></li></ul><h1 id="æ‰©å±•åŠŸèƒ½"><a href="#æ‰©å±•åŠŸèƒ½" class="headerlink" title="æ‰©å±•åŠŸèƒ½"></a>æ‰©å±•åŠŸèƒ½</h1><h2 id="ä»£ç ç”Ÿæˆ"><a href="#ä»£ç ç”Ÿæˆ" class="headerlink" title="ä»£ç ç”Ÿæˆ"></a>ä»£ç ç”Ÿæˆ</h2><p>æ¨èæ’ä»¶ï¼šMyBatisPlus</p><p>Config Database -&gt; è¿æ¥æ•°æ®åº“<br>Code Generator -&gt; é…ç½®ç›¸å…³å‚æ•°ï¼Œå¦‚ä¸‹å›¾</p><p><img src="/2025/08/21/MyBatis-Plus%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/2.png" alt="ç›¸å…³é…ç½®é¡¹è¯´æ˜"></p><h2 id="é™æ€å·¥å…·"><a href="#é™æ€å·¥å…·" class="headerlink" title="é™æ€å·¥å…·"></a>é™æ€å·¥å…·</h2><p>Dbæ˜¯ä¸€ä¸ªæä¾›é™æ€æ–¹æ³•çš„å·¥å…·ç±»ï¼Œç”¨äºç®€åŒ–æ•°æ®åº“æ“ä½œï¼Œæ— éœ€ç›´æ¥ä½¿ç”¨Mapperæˆ– Serviceå¯¹è±¡ï¼Œåœ¨ä¸€äº›åœºæ™¯ä¸‹å¯ä»¥æ›´æ–¹ä¾¿åœ°è¿›è¡ŒCRUDã€‚</p><ul><li>åœ¨å·¥å…·ç±»æˆ–éSpringç®¡ç†çš„ç±»ä¸­æ“ä½œæ•°æ®åº“</li><li>ç®€å•çš„CRUDæ“ä½œ</li><li>å¿«é€Ÿå¼€å‘æˆ–è„šæœ¬åœºæ™¯ï¼Œé¿å…æ³¨å…¥å¤šä¸ªService&#x2F;Mapper</li></ul><h2 id="é€»è¾‘åˆ é™¤"><a href="#é€»è¾‘åˆ é™¤" class="headerlink" title="é€»è¾‘åˆ é™¤"></a>é€»è¾‘åˆ é™¤</h2><p>åŸºäºä»£ç é€»è¾‘æ¨¡æ‹Ÿåˆ é™¤æ•ˆæœï¼Œä½†ä¸ä¼šçœŸæ­£åˆ é™¤æ•°æ®ï¼Œé€šè¿‡åœ¨è¡¨ä¸­æ·»åŠ <strong>åˆ é™¤æ ‡è¯†å­—æ®µ</strong>æ¥è¡¨ç¤ºæ˜¯å¦åˆ é™¤ï¼Œå½“åˆ é™¤æ•°æ®çš„æ—¶å€™å°†æ ‡è¯†ç½®ä¸º1ï¼ŒæŸ¥è¯¢æ—¶ï¼Œåˆ¤æ–­æ•°æ®åˆ é™¤çŠ¶æ€ï¼ŒåªæŸ¥è¯¢æ ‡è®°ä¸º0çš„æ•°æ®ã€‚</p><p>åº”ç”¨åœºæ™¯ï¼š</p><ul><li>éœ€è¦ä¿ç•™åˆ é™¤è®°å½•ç”¨äºç»Ÿè®¡æ—¶ï¼Œæ¯”å¦‚ç”¨æˆ·æ•°æ®ï¼Œè®¢å•è®°å½•ç­‰</li><li>è½¯åˆ é™¤+å›æ”¶ç«™åŠŸèƒ½</li><li>æ—¥å¿—éœ€æ±‚ï¼Œè¿½è¸ªåˆ é™¤æ—¶é—´ã€åˆ é™¤æ•°æ®ï¼Œä¾¿äºå®¡è®¡</li></ul><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><p>åœ¨application.yamlä¸­é…ç½®é€»è¾‘åˆ é™¤çš„å­—æ®µåç§°å’Œå€¼å°±å¯ä»¥ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">mybatis-plus:</span><br>        <span class="hljs-attr">global-config:</span><br>                <span class="hljs-attr">db-config:</span><br>                        <span class="hljs-attr">logic-delete-field:</span> <span class="hljs-string">flag</span>  <span class="hljs-comment"># å…¨å±€é€»è¾‘åˆ é™¤çš„å®ä½“å­—æ®µåï¼Œå­—æ®µç±»å‹å¯ä»¥æ˜¯booleanã€integer</span><br>                        <span class="hljs-attr">logic-delete-value:</span> <span class="hljs-number">1</span>  <span class="hljs-comment">#é€»è¾‘å·²åˆ é™¤å€¼(é»˜è®¤ä¸º1)</span><br>                        <span class="hljs-attr">logic-not-delete-value:</span> <span class="hljs-number">0</span>   <span class="hljs-comment">#é€»è¾‘æœªåˆ¶é™¤å€¼(é»˜è®¤ä¸º0)</span><br></code></pre></td></tr></table></figure><p>ç¼ºç‚¹ï¼š</p><ul><li>æ•°æ®åº“è¡¨ä¸­çš„åƒåœ¾æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œå½±å“æŸ¥è¯¢æ•ˆç‡</li><li>SQLè¯­å¥å…¨éƒ¨éœ€è¦å¯¹é€»è¾‘åˆ é™¤å­—æ®µåšåˆ¤æ–­ï¼Œå½±å“æŸ¥è¯¢æ•ˆç‡</li></ul><p>å¦‚æœéœ€è¦ä¿ç•™åˆ é™¤æ•°æ®ï¼Œæ¨èé‡‡ç”¨å°†æ•°æ®è¿ç§»åˆ°å…¶ä»–è¡¨çš„æ–¹æ³•</p><h2 id="æšä¸¾å¤„ç†å™¨"><a href="#æšä¸¾å¤„ç†å™¨" class="headerlink" title="æšä¸¾å¤„ç†å™¨"></a>æšä¸¾å¤„ç†å™¨</h2><p>æŸäº›è¡¨ä¸­å­—æ®µå¯èƒ½æ˜¯ä¸€ä¸ªçŠ¶æ€ç±»ï¼Œå¯ä»¥ç”¨æšä¸¾ç±»å»è¡¨ç¤ºï¼Œå°†çŠ¶æ€çš„æ•°å­—ç”¨æšä¸¾ç±»å‹å»æ”¹å†™ï¼Œä»£ç å¯è¯»æ€§å˜å¥½ã€‚ä½†æ•°æ®åº“ä¸­ï¼Œä»ç„¶ä½¿ç”¨intç±»å»è¡¨ç¤ºçŠ¶æ€ï¼Œæ‰€ä»¥é‡‡ç”¨MPçš„æšä¸¾å¤„ç†å™¨MybatisEnumTypeHandleræ¥è§£å†³ç±»å‹è½¬æ¢çš„é—®é¢˜ã€‚</p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><ol><li>åœ¨æšä¸¾ç±»ä¸­å¯¹åº”æ•°æ®åº“çš„å±æ€§å€¼åŠ ä¸Šæ³¨è§£@EnumValue</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Getter</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">GradeEnum</span> &#123;<br>    PRIMARY(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;å°å­¦&quot;</span>),<br>    SECONDARY(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;ä¸­å­¦&quot;</span>),<br>    HIGH(<span class="hljs-number">3</span>, <span class="hljs-string">&quot;é«˜ä¸­&quot;</span>);<br><br>    <span class="hljs-meta">@EnumValue</span> <span class="hljs-comment">// æ ‡è®°æ•°æ®åº“å­˜çš„å€¼æ˜¯code</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> code;<br>    pricate <span class="hljs-keyword">final</span> String desc;<br><br>    <span class="hljs-comment">// å…¶ä»–å±æ€§...</span><br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li>åœ¨application.yamlä¸­é…ç½®å…¨å±€æšä¸¾å¤„ç†å™¨</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">mybatis-plus:</span><br>  <span class="hljs-attr">configuration:</span><br>    <span class="hljs-attr">default-enum-type-handler:</span> <span class="hljs-string">xx.xx.xx.MyEnumTypeHandler</span><br></code></pre></td></tr></table></figure><ol start="3"><li>ä¿®æ”¹å®ä½“ç±»çš„å­—æ®µä¸ºæšä¸¾ç±»</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ¯”å¦‚è¿™æ˜¯ä¸€ä¸ªUserç±»</span><br><span class="hljs-keyword">private</span> GradeEnum grade; <span class="hljs-comment">// å¹´çº§</span><br></code></pre></td></tr></table></figure><h2 id="JSONå¤„ç†å™¨"><a href="#JSONå¤„ç†å™¨" class="headerlink" title="JSONå¤„ç†å™¨"></a>JSONå¤„ç†å™¨</h2><p>æ•°æ®åº“ä¸­æŸäº›è¡¨ä¸­å­—æ®µçš„æ•°æ®ç±»å‹ä¸ºJSONæ ¼å¼ï¼Œè€Œåœ¨javaä¸­ç”¨Stringè¿›è¡Œè¡¨ç¤ºï¼Œä¸ºäº†èƒ½å¤Ÿæå–å‡ºJSONä¸­æŸäº›å±æ€§å¯¹åº”çš„å€¼ï¼Œå¯ä»¥åœ¨javaä¸­å®šä¹‰å‡ºç›¸å…³çš„ç±»è¿›è¡Œæå–ï¼Œç„¶åç”¨JSONå¤„ç†å™¨AbstractJsonTypeHandleræ¥è§£å†³æ•°æ®åº“Jsonæ ¼å¼ä¸ç±»çš„è½¬æ¢ã€‚</p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><ol><li>å®šä¹‰Jsonå¯¹åº”çš„å®ä½“ç±» eg. OtherInfoç±»</li><li>åœ¨æ•°æ®åº“è¡¨å¯¹åº”çš„å®ä½“ç±»ä¸­çš„å±æ€§ä¸Šé…ç½®Jsonå¤„ç†å™¨@TableField(<strong>typeHandler</strong> &#x3D; JacksonTypeHandler.class)</li><li>å¼€å¯æ˜ å°„æ³¨è§£@TableName(<strong>autoResultMap</strong> &#x3D; true)</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@Accessors(chain = true)</span><br><span class="hljs-meta">@TableName(autoResultMap = true)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    <span class="hljs-keyword">private</span> Long id;<br>    ...<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¿…é¡»å¼€å¯æ˜ å°„æ³¨è§£</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@TableName</span>(autoResultMap = true)</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * é€‰æ‹©å¯¹åº”çš„ JSON å¤„ç†å™¨ï¼Œå¹¶ç¡®ä¿å­˜åœ¨å¯¹åº”çš„ JSON è§£æä¾èµ–åŒ…</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@TableField(typeHandler = JacksonTypeHandler.class)</span><br>    <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨ FastjsonTypeHandler</span><br>    <span class="hljs-comment">// @TableField(typeHandler = FastjsonTypeHandler.class)</span><br>    <span class="hljs-keyword">private</span> OtherInfo otherInfo;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ’ä»¶åŠŸèƒ½"><a href="#æ’ä»¶åŠŸèƒ½" class="headerlink" title="æ’ä»¶åŠŸèƒ½"></a>æ’ä»¶åŠŸèƒ½</h2><h3 id="åˆ†é¡µæ’ä»¶"><a href="#åˆ†é¡µæ’ä»¶" class="headerlink" title="åˆ†é¡µæ’ä»¶"></a>åˆ†é¡µæ’ä»¶</h3><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><ol><li>åœ¨é…ç½®ç±»ä¸­æ³¨å†ŒMyBatisPlusçš„æ ¸å¿ƒæ’ä»¶ï¼Œå¹¶æ·»åŠ åˆ†é¡µæ’ä»¶</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@MapperScan(&quot;scan.your.mapper.package&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisPlusConfig</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ·»åŠ åˆ†é¡µæ’ä»¶</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> MybatisPlusInterceptor <span class="hljs-title function_">mybatisPlusInterceptor</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// 1. åˆå§‹åŒ–æ ¸å¿ƒæ’ä»¶</span><br>        <span class="hljs-type">MybatisPlusInterceptor</span> <span class="hljs-variable">interceptor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MybatisPlusInterceptor</span>();<br>        <span class="hljs-comment">// 2. æ·»åŠ åˆ†é¡µæ’ä»¶</span><br>        <span class="hljs-type">PaginationInnerInterceptor</span> <span class="hljs-variable">pageIntercepter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PaginationInnerInterceptor</span>(DbType.MYSQL);<br>        pageIntercepter.setMaxLimit(<span class="hljs-number">1000L</span>); <span class="hljs-comment">// è®¾ç½®åˆ†é¡µä¸Šé™ï¼ˆå¯é€‰ï¼‰</span><br>        <span class="hljs-comment">// å¦‚æœé…ç½®å¤šä¸ªæ’ä»¶, åˆ‡è®°åˆ†é¡µæœ€åæ·»åŠ </span><br>        <span class="hljs-comment">// å¦‚æœæœ‰å¤šæ•°æ®æºå¯ä»¥ä¸é…å…·ä½“ç±»å‹, å¦åˆ™éƒ½å»ºè®®é…ä¸Šå…·ä½“çš„ DbType</span><br>        <span class="hljs-keyword">return</span> interceptor;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li>ä½¿ç”¨åˆ†é¡µçš„APIçš„demo</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testPageQuery</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">// 1.æŸ¥è¯¢ï¼ˆé¡µç ï¼Œæ¯é¡µæ¡æ•°ï¼‰</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">pageNo</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>, pageSize = <span class="hljs-number">5</span>;<br>        <span class="hljs-comment">// 1.1.åˆ†é¡µå‚æ•°</span><br>        Page&lt;User&gt; page = Page.of(pageNo, pageSize);<br>        <span class="hljs-comment">// 1.2.æ’åºå‚æ•°ï¼Œé€šè¿‡OrderItemæ¥æŒ‡å®šï¼Œfalseè¡¨ç¤ºé™åº</span><br>        page.addOrder(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderItem</span>(<span class="hljs-string">&quot;balance&quot;</span>, <span class="hljs-literal">false</span>));<br>        <span class="hljs-comment">// 1.3.åˆ†é¡µæŸ¥è¯¢</span><br>        Page&lt;User&gt; p = userService.page(page);<br><br>        <span class="hljs-comment">// 2.æ€»æ¡æ•°</span><br>        System.out.println(<span class="hljs-string">&quot;total=&quot;</span>+ p.getTotal());<br>        <span class="hljs-comment">// 3.æ€»é¡µæ•°</span><br>        System.out.println(<span class="hljs-string">&quot;pages =&quot;</span>+ p.getPages());<br>        <span class="hljs-comment">// 4.åˆ†é¡µæ•°æ®</span><br>        List&lt;User&gt; records = p.getRecords();<br>        records.forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é€šç”¨åˆ†é¡µå®ä½“"><a href="#é€šç”¨åˆ†é¡µå®ä½“" class="headerlink" title="é€šç”¨åˆ†é¡µå®ä½“*"></a>é€šç”¨åˆ†é¡µå®ä½“*</h3><p>æ ¸å¿ƒæ€è·¯ï¼š</p><ul><li><p>å®šä¹‰ç»Ÿä¸€çš„æŸ¥è¯¢å®ä½“PageQueryï¼Œå®ç°æŸ¥è¯¢æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PageQuery</span> &#123;<br>      <span class="hljs-keyword">private</span> Integer pageNo; <span class="hljs-comment">//é¡µç </span><br>      <span class="hljs-keyword">private</span> Integer pageSize; <span class="hljs-comment">//é¡µå®¹é‡</span><br>      <span class="hljs-keyword">private</span> String sortBy; <span class="hljs-comment">//æ’åºå­—æ®µ</span><br>      <span class="hljs-keyword">private</span> Boolean isAsc; <span class="hljs-comment">//æ˜¯å¦å‡åº</span><br><br>      <span class="hljs-keyword">public</span> &lt;T&gt; Page&lt;T&gt; <span class="hljs-title function_">toMpPage</span><span class="hljs-params">(orderItem ... items)</span>&#123;<br>              <span class="hljs-comment">// 1.åˆ†é¡µæ¡ä»¶</span><br>              Page&lt;T&gt; page =Page.of(pageNo, pageSize);<br>              <span class="hljs-comment">// 2.æ’åºæ¡ä»¶</span><br>              <span class="hljs-keyword">if</span>(strutil.isNotBlank(sortBy))&#123;<br>                      <span class="hljs-comment">// ä¸ä¸ºç©º</span><br>                      page.addorder(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderItem</span>(sortBy isAsc));<br>              &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(items != <span class="hljs-literal">null</span>)&#123;<br>                      <span class="hljs-comment">// ä¸ºç©ºï¼Œé»˜è®¤æ’åº</span><br>                      page.addorder(items);<br>              &#125;<br>              <span class="hljs-keyword">return</span> page;<br>      &#125;<br><br>      <span class="hljs-keyword">public</span> &lt;T&gt; Page&lt;T&gt; <span class="hljs-title function_">toMpPage</span><span class="hljs-params">(String defaltSortBy, Boolean defaultAsc)</span>&#123;<br>              <span class="hljs-keyword">return</span> toMpPage(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderItem</span>(defaltSortBy, defaultAsc));<br>      &#125;<br><br>      <span class="hljs-comment">// å¸¸ç”¨çš„é»˜è®¤æ’åºå¯ä»¥ç›´æ¥å®šä¹‰å‡ºæ¥ï¼Œæ–¹ä¾¿ä½¿ç”¨</span><br>      <span class="hljs-keyword">public</span> &lt;T&gt; Page&lt;T&gt; <span class="hljs-title function_">toMpPageDefaultSortByCreateTime</span><span class="hljs-params">()</span>&#123;<br>              <span class="hljs-keyword">return</span> toMpPage(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderItem</span>(<span class="hljs-string">&quot;create_time&quot;</span>, <span class="hljs-literal">false</span>));<br>      &#125;<br></code></pre></td></tr></table></figure></li><li><p>å°è£…ç»Ÿä¸€çš„è¿”å›å®ä½“PageDTOå’Œè¿”å›æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PageDTO</span>&lt;T&gt;&#123;<br>      <span class="hljs-keyword">private</span> Long total; <span class="hljs-comment">//æ€»æ¡æ•°</span><br>      <span class="hljs-keyword">private</span> Long pages; <span class="hljs-comment">//æ€»é¡µæ•°</span><br>      <span class="hljs-keyword">private</span> List&lt;T&gt; list; <span class="hljs-comment">//é›†åˆ</span><br><br>      <span class="hljs-comment">// POè½¬VOå¯¹è±¡è¿”å›</span><br>      <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;PO, VO&gt; PageDTO&lt;VO&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(Page&lt;PO&gt; p, Class&lt;VO&gt; clazz)</span>&#123;<br>              PageDTO&lt;VO&gt; dto = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PageDTO</span>&lt;&gt;();<br>              <span class="hljs-comment">// æ€»æ¡æ•°</span><br>              dto.setTotal(p.getTotal());<br>              <span class="hljs-comment">// æ€»é¡µæ•°</span><br>              dto.setPages(p.getPages());<br>              <span class="hljs-comment">// å½“å‰é¡µæ•°æ®</span><br>              List&lt;PO&gt; records = p.getRecords();<br>              <span class="hljs-keyword">if</span>(CollUtil.isEmpty(records))&#123;<br>                      dto.setList(Collections.emptyList());<br>                      <span class="hljs-keyword">return</span> dto;<br>              &#125;<br>              <span class="hljs-comment">// æ‹·è´voåˆ°po</span><br>              dto.setList(BeanUtil.copyToList(records, clazz));<br>              <span class="hljs-comment">// è¿”å›</span><br>              <span class="hljs-keyword">return</span> dto;<br>      &#125;<br></code></pre></td></tr></table></figure></li><li><p>åœ¨éœ€è¦åˆ†é¡µæŸ¥è¯¢çš„å®ä½“ç±»ä¸­ç»§æ‰¿ä¸Šè¿°çš„å®ä½“ï¼Œä½¿ç”¨æ–¹æ³•</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€Šå¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ç†è®ºä¸å®è·µã€‹RAGç« èŠ‚ç¬”è®°</title>
    <link href="/2025/08/21/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/"/>
    <url>/2025/08/21/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<blockquote><p>ã€Šå¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ç†è®ºä¸å®è·µã€‹ç¬¬äºŒç‰ˆï¼š<a href="https://intro-llm.github.io/">åŸä¹¦èµ„æ–™é“¾æ¥ğŸ”—</a></p></blockquote><h2 id="RAGç³»ç»Ÿæ¡†æ¶"><a href="#RAGç³»ç»Ÿæ¡†æ¶" class="headerlink" title="RAGç³»ç»Ÿæ¡†æ¶"></a>RAGç³»ç»Ÿæ¡†æ¶</h2><p>RAGæ ¸å¿ƒåœ¨äºå°†<strong>å¤–éƒ¨æ£€ç´¢</strong>ä¸<strong>ç”Ÿæˆæ¨¡å—</strong>æœ‰æœºæ•´åˆï¼Œé€šè¿‡åŠ¨æ€å¼•å…¥å¤–éƒ¨çŸ¥è¯†æ¥æå‡ç”Ÿæˆç»“æœçš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚</p><p><img src="/../images/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/rag_frame.png" alt="RAGç³»ç»Ÿæ¡†æ¶" title="RAGç³»ç»Ÿæ¡†æ¶ç¤ºæ„å›¾">  </p><h2 id="RAGä»»åŠ¡åˆ†çº§"><a href="#RAGä»»åŠ¡åˆ†çº§" class="headerlink" title="RAGä»»åŠ¡åˆ†çº§"></a>RAGä»»åŠ¡åˆ†çº§</h2><p>æ ¹æ®ä»»åŠ¡è®¤çŸ¥å¤„ç†å±‚æ¬¡åˆ’åˆ†ï¼Œå¯åˆ†ä¸ºæ˜¾æ€§äº‹å®æŸ¥è¯¢ï¼ˆExplicit Facts Queryï¼‰ã€éšæ€§äº‹å®æŸ¥è¯¢ï¼ˆImplicit Facts Queryï¼‰ã€å¯è§£é‡Šæ¨ç†æŸ¥è¯¢ï¼ˆInterpretable Rationales Queryï¼‰ä»¥åŠéšæ€§æ¨ç†æŸ¥è¯¢ï¼ˆHidden Rationales Queryï¼‰ç­‰å››ä¸ªå±‚çº§ã€‚</p><h2 id="æ¨¡å—åŒ–RAGæ¶æ„"><a href="#æ¨¡å—åŒ–RAGæ¶æ„" class="headerlink" title="æ¨¡å—åŒ–RAGæ¶æ„"></a>æ¨¡å—åŒ–RAGæ¶æ„</h2><p>åŒæµå¤§å­¦ç‹æ˜Šå¥‹æ•™æˆå›¢é˜Ÿå€Ÿé‰´äº†æ¨¡å—åŒ–è®¾è®¡çš„æ€æƒ³ï¼Œæå‡ºäº†æ¨¡å—åŒ–æ£€ç´¢å¢å¼ºç”Ÿæˆæ¶æ„ï¼ˆModular RAGï¼‰ã€‚åŸæ–‡è¿æ¥ï¼š<a href="https://ojs.aaai.org/index.php/AAAI/article/view/29934">LLMEval: A Preliminary Study on How to Evaluate Large Language Models</a></p><p><img src="/2025/08/21/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/model_rag.png" alt="Modular RAG æ¶æ„"></p><h3 id="ç´¢å¼•æ¨¡å—"><a href="#ç´¢å¼•æ¨¡å—" class="headerlink" title="ç´¢å¼•æ¨¡å—"></a>ç´¢å¼•æ¨¡å—</h3><p>è¯¥æ¨¡å—çš„æ ¸å¿ƒä»»åŠ¡æ˜¯å°†æ–‡æ¡£åˆ’åˆ†ä¸ºå¯ç®¡ç†çš„chunkï¼ˆå—ï¼‰ï¼Œä¸ºåç»­çš„æ£€ç´¢å’Œç”Ÿæˆæä¾›ç»„ç»‡è‰¯å¥½çš„å†…å®¹åŸºç¡€ï¼Œ</p><p>ç›®å‰æ–¹æ³•ï¼š</p><ul><li>å—ä¼˜åŒ–ï¼š<ol><li>å‘é‡å—ä¼˜åŒ–ï¼šç”¨<strong>æ»‘åŠ¨çª—å£</strong>æ–¹æ³•é€šè¿‡åœ¨ç›¸é‚»ç‰‡æ®µä¹‹é—´å¼•å…¥é‡å åŒºåŸŸ</li><li>è¯­ä¹‰å—åˆ‡åˆ†ï¼šå¯¹æ–‡æ¡£åˆ†æ®µï¼Œå¹¶å¯¹æ¯ä¸€æ®µ<strong>ç”ŸæˆåµŒå…¥å‘é‡</strong>ï¼Œé€šè¿‡æ¯”è¾ƒç›¸é‚»æ®µè½çš„å‘é‡ç›¸ä¼¼åº¦è¿›è¡Œåˆå¹¶</li><li>å°åˆ°å¤§ï¼šé€šè¿‡å°†ç”¨äºæ£€ç´¢çš„ç‰‡æ®µä¸ç”¨äºç”Ÿæˆçš„ç‰‡æ®µåˆ†å¼€å¤„ç†</li></ol></li><li>ç»“æ„ä¼˜åŒ–<ol><li>å±‚æ¬¡åŒ–ç´¢å¼•ï¼šé€šè¿‡å»ºç«‹çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹ä¹‹é—´çš„å…³è”å…³ç³»ï¼Œå°†æ–‡æ¡£å†…å®¹åˆ†è§£ä¸ºä¸åŒå±‚æ¬¡çš„ç‰‡æ®µï¼Œå¹¶é“¾æ¥åˆ°ç›¸åº”çš„èŠ‚ç‚¹ä¸Š</li><li>çŸ¥è¯†å›¾è°±ç´¢å¼•ï¼šé€šè¿‡å°†æ–‡æ¡£ç»„ç»‡ä¸ºå›¾ç»“æ„ï¼Œæ˜ç¡®æ¦‚å¿µä¸å®ä½“ä¹‹é—´çš„å…³ç³»</li></ol></li></ul><h3 id="æ£€ç´¢å‰ä¼˜åŒ–"><a href="#æ£€ç´¢å‰ä¼˜åŒ–" class="headerlink" title="æ£€ç´¢å‰ä¼˜åŒ–"></a>æ£€ç´¢å‰ä¼˜åŒ–</h3><p>é¢„æ£€ç´¢æ¨¡å—é€šè¿‡å¯¹ç”¨æˆ·æŸ¥è¯¢è¿›è¡Œé‡æ„ã€æ‰©å±•æˆ–è¯­ä¹‰ä¼˜åŒ–ï¼Œèƒ½å¤Ÿå‡å°‘è¯­è¨€æ­§ä¹‰å’Œè¡¨è¿°æ¨¡ç³Šï¼Œä»è€Œä¸ºä¸‹æ¸¸æ£€ç´¢ä»»åŠ¡æä¾›æ›´ç²¾å‡†çš„è¾“å…¥ã€‚ä¸»è¦æ¨¡å—å¦‚ä¸‹ï¼š</p><ol><li><p>æŸ¥è¯¢æ‰©å±•ï¼šé€šè¿‡å°†å•ä¸€æŸ¥è¯¢<strong>æ‰©å±•</strong>ä¸ºå¤šä¸ªæŸ¥è¯¢çš„æ–¹æ³•ï¼Œç”¨ä»¥ä¸°å¯ŒæŸ¥è¯¢çš„å†…å®¹ï¼Œä»è€Œå¼¥è¡¥åŸå§‹æŸ¥è¯¢ä¸­å¯èƒ½ç¼ºä¹çš„ç»†èŠ‚å’Œè¯­ä¹‰ä¿¡æ¯</p></li><li><p>æŸ¥è¯¢è½¬æ¢ï¼šå¯¹ç”¨æˆ·è¾“å…¥çš„æŸ¥è¯¢è¿›è¡Œ<strong>è¯­ä¹‰ä¼˜åŒ–</strong>ã€<strong>è¯­è¨€ç®€åŒ–</strong>æˆ–<strong>ç»“æ„è°ƒæ•´</strong>ï¼Œä½¿å…¶æ›´åŠ æ˜ç¡®å’Œç²¾ç¡®ï¼Œä¾¿äºæ¨¡å‹è¯†åˆ«æ ¸å¿ƒæ„å›¾å¹¶ç”Ÿæˆç›¸å…³ç­”æ¡ˆ</p></li><li><p>æŸ¥è¯¢ç»“æ„åŒ–ï¼šå°†ç”¨æˆ·çš„æŸ¥è¯¢é‡æ–°æ„å»ºä¸ºé€‚åº”ä¸åŒæ•°æ®ç±»å‹ï¼Œä¾‹å¦‚<strong>ç»“æ„åŒ–æ•°æ®</strong>ï¼ˆå¦‚è¡¨æ ¼å’Œå›¾å½¢æ•°æ®ï¼‰çš„æŸ¥è¯¢</p></li></ol><h2 id="æ£€ç´¢"><a href="#æ£€ç´¢" class="headerlink" title="æ£€ç´¢"></a>æ£€ç´¢</h2><p>æ£€ç´¢æ¨¡å—éœ€è¦èƒ½å¤Ÿé«˜æ•ˆåœ°å¤„ç†å¤§é‡çš„æ–‡æœ¬æ•°æ®ï¼Œå¹¶ä¸”éœ€è¦èƒ½å¤Ÿå‡†ç¡®åœ°è¯†åˆ«å’ŒåŒ¹é…æŸ¥è¯¢å’Œæ–‡æ¡£ä¹‹é—´çš„è¯­ä¹‰ç›¸ä¼¼æ€§ã€‚ç›®å‰çš„æ£€ç´¢ä¸»è¦åˆ†ä¸ºï¼šç¨€ç–æ£€ç´¢ã€ç¨ å¯†æ£€ç´¢å’Œæ··åˆæ£€ç´¢ã€‚</p><ol><li>ç¨€ç–æ£€ç´¢</li></ol><p><img src="/2025/08/21/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/1.png" alt="ç¨€ç–æ£€ç´¢æ¶æ„å›¾"></p><p>å…¶ç‰¹ç‚¹ä¸ºï¼š</p><ul><li>æ˜¯ä¸€ç§åŸºäºç»Ÿè®¡ç‰¹å¾çš„æ–¹æ³•</li><li>é€šè¿‡å°†æŸ¥è¯¢æˆ–æ–‡æ¡£è½¬æ¢ä¸ºç¨€ç–å‘é‡ï¼ˆå¤§éƒ¨åˆ†å…ƒç´ ä¸º0çš„å‘é‡ï¼‰æ¥å®ç°æ£€ç´¢</li><li>é€‚ç”¨åœºæ™¯ï¼šå¤§è§„æ¨¡æ–‡æ¡£åº“çš„æ£€ç´¢ä»»åŠ¡</li><li>ä¼˜ç‚¹ï¼šè®¡ç®—å¤æ‚åº¦è¾ƒä½ï¼Œåœ¨èµ„æºæœ‰é™æˆ–è€…å®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ä¸­è¡¨ç°çªå‡º</li><li>ç¼ºç‚¹ï¼šåœ¨æ•æ‰å¤æ‚è¯­ä¹‰å…³ç³»ä¸Šå­˜åœ¨å±€é™æ€§ï¼Œæ— æ³•æœ‰æ•ˆå¤„ç†åŒä¹‰è¯ã€ä¸Šä¸‹æ–‡è¯­æ„ç­‰æ·±å±‚è¯­ä¹‰ä¿¡æ¯</li></ul><ol start="2"><li>ç¨ å¯†æ£€ç´¢</li></ol><p><img src="/2025/08/21/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/2.png" alt="ç¨ å¯†æ£€ç´¢æ¶æ„å›¾"></p><p>å…¶ç‰¹ç‚¹ä¸ºï¼š</p><ul><li>é€šè¿‡DRLå°†æŸ¥è¯¢æˆ–æ–‡æ¡£ç¼–ç ä¸ºç¨ å¯†å‘é‡</li><li>ä¾èµ–äºé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹æ´»ç‰¹å®šçš„åŒå¡”æ¨¡å‹ç”Ÿæˆè¯­ä¹‰åµŒå…¥</li><li>ä¼˜ç‚¹ï¼šå…·æœ‰å¼ºå¤§çš„è¯­ä¹‰è¡¨è¾¾èƒ½åŠ›ï¼Œå¯ä»¥å¤„ç†åŒä¹‰è¯ç­‰æ·±å±‚è¯­ä¹‰ä¿¡æ¯</li><li>ç¼ºç‚¹ï¼šåœ¨è®¡ç®—æˆæœ¬å’Œå­˜å‚¨è¦æ±‚æ–¹é¢æœ‰å±€é™æ€§</li></ul><ol start="3"><li>æ··åˆæ£€ç´¢</li></ol><p>å°†ç¨€ç–å‘é‡å’Œç¨ å¯†å‘é‡çš„å¾—åˆ†è¿›è¡Œèåˆæ´»åœ¨æ£€ç´¢æµç¨‹ä¸­åˆ†é˜¶æ®µä½¿ç”¨</p><p><img src="/2025/08/21/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/3.png" alt="æ··åˆæ£€ç´¢æ¶æ„å›¾"></p><h2 id="æ£€ç´¢åä¼˜åŒ–"><a href="#æ£€ç´¢åä¼˜åŒ–" class="headerlink" title="æ£€ç´¢åä¼˜åŒ–"></a>æ£€ç´¢åä¼˜åŒ–</h2><p>é€šè¿‡å¯¹æ£€ç´¢å†…å®¹è¿›è¡Œåå¤„ç†ï¼Œè§£å†³â€œä¸­é—´é—å¿˜â€ã€â€œå™ªå£°&#x2F;åäº‹å®â€æ–‡æœ¬ä»¥åŠä¸Šä¸‹æ–‡çª—å£é•¿åº¦æœ‰é™ç­‰é—®é¢˜ã€‚è¯¥éƒ¨åˆ†çš„å¸¸è§ç»„æˆéƒ¨åˆ†åŒ…æ‹¬é‡æ’åºï¼ˆRerankï¼‰ã€å†…å®¹å‹ç¼©ä»¥åŠå†…å®¹é€‰æ‹©ç­‰æ­¥éª¤ã€‚</p><ol><li><p>é‡æ’åº<br>å…¶ä¸»è¦ç›®çš„æ˜¯å¯¹æ£€ç´¢åˆ°çš„æ–‡ç« ç‰‡æ®µï¼ˆchunksï¼‰è¿›è¡Œé‡æ–°æ’åºï¼Œä»¥æå‡ç»“æœçš„ç›¸å…³æ€§å’Œå¤šæ ·æ€§ã€‚</p><ol><li>åŸºäºè§„åˆ™ï¼šè®¡ç®—æŒ‡æ ‡å¯¹chunkè¿›è¡Œæ’åºï¼›æŒ‡æ ‡åŒ…å¤šæ ·æ€§ï¼Œç›¸å…³æ€§å’Œæœ€å¤§è¾¹é™…ç›¸å…³æ€§</li><li>åŸºäºæ¨¡å‹ï¼šè®¡ç®—chunkä¸æŸ¥è¯¢ä¹‹é—´çš„ç›¸å…³æ€§æ¥æ’åº</li></ol></li><li><p>å†…å®¹å‹ç¼©<br>å‹ç¼©çš„æ ¸å¿ƒç›®æ ‡æ˜¯é€šè¿‡å†…å®¹å‹ç¼©å‡å°‘å™ªå£°ï¼ŒåŒæ—¶ä¿ç•™ä¿¡æ¯å®Œæ•´æ€§ï¼Œä»¥æé«˜è¯­è¨€æ¨¡å‹çš„æ¨ç†æ•ˆç‡ã€‚</p><ol><li>é€šè¿‡å°è¯­è¨€æ¨¡å‹å¯¹æ£€ç´¢å†…å®¹è¿›è¡Œå¯¹é½å’Œé¢„è®­ç»ƒ</li><li>åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹å¯¹æ£€ç´¢å†…å®¹è¿›è¡Œè¯„ä¼°</li></ol></li><li><p>å†…å®¹é€‰æ‹©<br>å…³é”®åœ¨äºè®¡ç®—è¾“å…¥å†…å®¹çš„è‡ªä¿¡æ¯é‡ï¼ˆä¸€ç§è¡¡é‡å†…å®¹ä¿¡æ¯ä»·å€¼çš„æŒ‡æ ‡ï¼‰</p></li></ol><h2 id="ç”Ÿæˆ"><a href="#ç”Ÿæˆ" class="headerlink" title="ç”Ÿæˆ"></a>ç”Ÿæˆ</h2><p>ç”Ÿæˆæ¨¡å—æ˜¯æ•´ä¸ª RAG ç³»ç»Ÿçš„çš„æ ¸å¿ƒæ¨¡å—ï¼Œè´Ÿè´£åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹ç»“åˆç”¨æˆ·æŸ¥è¯¢ä¸æ£€ç´¢åˆ°çš„ä¸Š<br>ä¸‹æ–‡ä¿¡æ¯ç”Ÿæˆç­”æ¡ˆ</p><h2 id="ç¼–æ’"><a href="#ç¼–æ’" class="headerlink" title="ç¼–æ’"></a>ç¼–æ’</h2><p>ç¼–æ’æ¨¡å—æ˜¯RAGç³»ç»Ÿ<strong>æ ¸å¿ƒæ§åˆ¶å•å…ƒ</strong>ï¼Œè´Ÿè´£åœ¨å…³é”®èŠ‚ç‚¹è¿›è¡Œå†³ç­–å¹¶åŠ¨æ€é€‰æ‹©åç»­æ­¥éª¤ã€‚ä¸»è¦æ¨¡å—åŒ…æ‹¬è·¯ç”±ï¼ˆRoutingï¼‰ã€è°ƒåº¦ï¼ˆSchedulingï¼‰ä»¥åŠèåˆï¼ˆFusionï¼‰ã€‚</p><ol><li><p>è·¯ç”±<br>é€šè¿‡è·¯ç”±æœºåˆ¶å°†æŸ¥è¯¢åˆ†é…åˆ°é’ˆå¯¹ä¸åŒåœºæ™¯è®¾è®¡çš„ç‰¹å®šç®¡é“ä¸­</p><ol><li>å…ƒæ•°æ®è·¯ç”±ï¼š</li></ol><pre><code class="hljs"> a. åŸºäºæŸ¥è¯¢ä¸­æå–çš„å…³é”®æœ¯è¯­æˆ–å®ä½“ï¼Œé€šè¿‡ä¸é¢„è®¾å…³é”®è¯é›†åˆçš„åŒ¹é…æ¥ä¼˜åŒ–è·¯ç”±æµç¨‹ b. é€‚åˆå¯¹æ˜¾æ€§å…³é”®è¯é«˜åº¦æ•æ„Ÿçš„åœºæ™¯ c. åŒ¹é…åˆ†æ•°ç”±å…³é”®è¯çš„é‡å æ¯”ä¾‹è®¡ç®—å¾—å‡º</code></pre><ol start="2"><li>è¯­ä¹‰è·¯ç”±</li></ol><pre><code class="hljs"> a. ä¾èµ–æŸ¥è¯¢çš„è¯­ä¹‰ä¿¡æ¯ï¼Œé€šè¿‡è¯­è¨€æ¨¡å‹è®¡ç®—æŸ¥è¯¢ä¸é¢„å®šä¹‰æ„å›¾çš„åŒ¹é…æ¦‚ç‡</code></pre><ol start="3"><li>æ··åˆè·¯ç”±</li></ol><pre><code class="hljs"> a. é€šè¿‡å¼•å…¥æƒé‡å› å­ï¼Œæ··åˆè·¯ç”±åœ¨å…ƒæ•°æ®åŒ¹é…å’Œè¯­ä¹‰åˆ†æä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹ï¼Œä»è€Œå®ç°æ›´ç²¾ç¡®çš„è·¯ç”±é€‰æ‹©</code></pre></li><li><p>è°ƒåº¦<br>   è°ƒåº¦æ¨¡å—çš„ä½œç”¨æ˜¯è¯†åˆ«å…³é”®èŠ‚ç‚¹ï¼Œè´Ÿè´£ç®¡ç†å’Œåè°ƒç³»ç»Ÿçš„å„ä¸ªæµç¨‹ï¼Œæ˜¯å¦éœ€è¦å¯åŠ¨è¿›ä¸€æ­¥çš„æ£€ç´¢ç­‰</p><ol><li>è§„åˆ™åˆ¤å®šï¼š</li></ol><pre><code class="hljs">a. ç”¨äºè¯„ä¼°ç”Ÿæˆç­”æ¡ˆçš„è´¨é‡å¹¶å†³å®šè¿›ä¸€æ­¥çš„æ“ä½œb. é€šè¿‡è¯„åˆ†æœºåˆ¶å¯¹ç”Ÿæˆçš„ç­”æ¡ˆè¿›è¡Œè´¨é‡è¯„ä¼°ï¼Œå¹¶æ ¹æ®é¢„è®¾çš„é˜ˆå€¼åˆ¤æ–­æ˜¯å¦ç»§ç»­æˆ–ç»ˆæ­¢ç”Ÿæˆè¿‡ç¨‹</code></pre><ol start="2"><li>LLMåˆ¤æ–­</li></ol><pre><code class="hljs">a. åˆ©ç”¨LLMçš„ä¸Šä¸‹æ–‡å­¦ä¹ èƒ½åŠ›b. é€šè¿‡å¯¹LLMè¿›è¡Œå¾®è°ƒ</code></pre><ol start="3"><li>çŸ¥è¯†å¼•å¯¼è°ƒåº¦</li></ol><pre><code class="hljs">a. é€šè¿‡çŸ¥è¯†å›¾è°±å¼•å¯¼ä¿¡æ¯æ£€ç´¢ä¸ç”Ÿæˆè¿‡ç¨‹</code></pre></li><li><p>èåˆ<br>å½“ç³»ç»Ÿæ‹“å®½æ£€ç´¢èŒƒå›´æˆ–æ¢ç´¢å¤šæ¡ç®¡é“ä»¥æå‡ç”Ÿæˆå†…å®¹çš„å¤šæ ·æ€§æ—¶ï¼Œèåˆæ¨¡å—è´Ÿè´£é«˜æ•ˆ<strong>æ•´åˆ</strong>å„åˆ†æ”¯ç”Ÿæˆçš„ä¿¡æ¯ã€‚èåˆæ¨¡å—ä¸»è¦åŒ…å«å¤§è¯­è¨€æ¨¡å‹èåˆã€åŠ æƒé›†æˆä»¥åŠå€’æ•°æ’åèåˆç­‰æ–¹æ³•ã€‚</p><ol><li><p>å¤§è¯­è¨€æ¨¡å‹èåˆï¼š<br>  åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹å¼ºå¤§çš„åˆ†æä¸æ•´åˆèƒ½åŠ›ï¼Œå°†ä¸åŒåˆ†æ”¯çš„ä¿¡æ¯è¿›è¡Œç»Ÿä¸€å¤„ç†ã€‚ä¸ºäº†è§£å†³è¶…å‡ºä¸Šä¸‹æ–‡çª—å£é™åˆ¶çš„é•¿ç­”æ¡ˆæ—¶ï¼Œé€šè¿‡å…ˆå¯¹æ¯ä¸ªåˆ†æ”¯çš„ç­”æ¡ˆè¿›è¡Œ<strong>æ‘˜è¦æå–</strong>åå†è¾“å…¥LLMçš„æ–¹å¼æ¥è¿›è¡Œæ•´åˆã€‚</p></li><li><p>åŠ æƒé›†æˆï¼š<br>  æ˜¯ä¸€ç§åŸºäºå¤šåˆ†æ”¯ç”Ÿæˆç»“æœçš„åŠ æƒé€‰æ‹©æ–¹æ³•ï¼Œé€šè¿‡ä¸åŒåˆ†æ”¯ç”Ÿæˆçš„è¯å…ƒï¼ˆtokenï¼‰çš„åŠ æƒå€¼æ¥ç»¼åˆé€‰æ‹©æœ€ç»ˆè¾“å‡ºã€‚</p></li><li><p>å€’æ•°æ’åèåˆï¼š<br>  å®ƒé€šè¿‡ä¸€ç§å®šåˆ¶çš„<strong>åŠ æƒå¹³å‡æ–¹æ³•</strong>ï¼Œå¢å¼ºäº†æ•´ä½“é¢„æµ‹æ€§èƒ½ä¸æ’åç²¾åº¦ã€‚é€‚åˆå¤„ç†æ¨¡å‹æˆ–æ¥æºå¼‚æ„çš„åœºæ™¯ã€‚</p></li></ol></li></ol><h2 id="RAGç³»ç»Ÿæ¨¡å¼"><a href="#RAGç³»ç»Ÿæ¨¡å¼" class="headerlink" title="RAGç³»ç»Ÿæ¨¡å¼"></a>RAGç³»ç»Ÿæ¨¡å¼</h2><h3 id="çº¿æ€§æ¨¡å¼"><a href="#çº¿æ€§æ¨¡å¼" class="headerlink" title="çº¿æ€§æ¨¡å¼"></a>çº¿æ€§æ¨¡å¼</h3><p>çº¿æ€§æ¨¡å¼æ˜¯æœ€ç®€å•ä¸”æœ€å¸¸ç”¨çš„å·¥ä½œæµæ¨¡å¼ï¼Œå…¶æµç¨‹å¯ä»¥åˆ†ä¸ºå‡ ä¸ªæ ¸å¿ƒæ¨¡å—ï¼ŒåŒ…æ‹¬é¢„æ£€ç´¢ï¼ˆPre-Retrievalï¼‰ã€æ£€ç´¢ã€åæ£€ç´¢ï¼ˆPost-Retrievalï¼‰ä»¥åŠç”Ÿæˆæ¨¡å—ã€‚</p><p><img src="/2025/08/21/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/4.png" alt="çº¿æ€§æ¨¡å‹æµç¨‹"></p><h3 id="æ¡ä»¶æ¨¡å¼"><a href="#æ¡ä»¶æ¨¡å¼" class="headerlink" title="æ¡ä»¶æ¨¡å¼"></a>æ¡ä»¶æ¨¡å¼</h3><p>æ¡ä»¶æ¨¡å¼æ˜¯ä¸€ç§çµæ´»çš„ RAG æµæ¨¡å¼ï¼Œå…¶æ ¸å¿ƒç‰¹ç‚¹æ˜¯åœ¨ä¸åŒæ¡ä»¶ä¸‹é€‰æ‹©ä¸åŒçš„ RAG æµæ°´çº¿ï¼Œ<br>ä»è€Œé’ˆå¯¹ç‰¹å®šåœºæ™¯è¿›è¡Œä¼˜åŒ–ã€‚å…·ä½“æ¥è¯´ï¼Œæ¡ä»¶æ¨¡å¼é€šè¿‡ä¸€ä¸ª<strong>è·¯ç”±æ¨¡å—</strong>ï¼ˆRouting Moduleï¼‰å®ç°æ¨¡å—çš„åŠ¨æ€é€‰æ‹©ï¼Œè¯¥æ¨¡å—æ ¹æ®è¾“å…¥é—®é¢˜çš„æ€§è´¨å†³å®šæ¥ä¸‹æ¥çš„æµç¨‹ã€‚</p><p><img src="/2025/08/21/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/5.png" alt="æ¡ä»¶æ¨¡å‹æµç¨‹"></p><p>æ¡ä»¶æ¨¡å¼çš„åˆ†æ”¯æµé€šå¸¸åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢å­˜åœ¨å·®å¼‚ï¼šæ£€ç´¢æ¥æºã€æµç¨‹ã€æ¨¡å‹é…ç½®ä»¥åŠæç¤ºè®¾è®¡</p><h3 id="åˆ†æ”¯æ¨¡å‹"><a href="#åˆ†æ”¯æ¨¡å‹" class="headerlink" title="åˆ†æ”¯æ¨¡å‹"></a>åˆ†æ”¯æ¨¡å‹</h3><p>åˆ†æ”¯æ¨¡å¼é€šè¿‡<strong>å¹¶è¡Œè¿è¡Œ</strong>å¤šä¸ªåˆ†æ”¯çš„æ–¹å¼å¢åŠ ç»“æœçš„å¤šæ ·æ€§å’Œé²æ£’æ€§ã€‚å…·ä½“æ¥è¯´ï¼Œåˆ†æ”¯æ¨¡å¼åœ¨æŸä¸ªæ¨¡å—ä¸­ç”Ÿæˆå¤šä¸ªå¹¶è¡Œåˆ†æ”¯ï¼Œæ¯ä¸ªåˆ†æ”¯å¯ä»¥ç‹¬ç«‹æ‰§è¡Œç›¸åŒæˆ–ä¸åŒçš„ RAG æµç¨‹ã€‚è¿™äº›æµç¨‹ç”±å¤šä¸ªå¤„ç†æ¨¡å—ç»„æˆï¼Œç”Ÿæˆå„è‡ªçš„åˆ†æ”¯è¾“å‡ºç»“æœã€‚</p><p>åˆ†æ”¯æ¨¡å¼å¯ä»¥æ ¹æ®ä¸åŒä»»åŠ¡éœ€æ±‚è®¾è®¡ä¸ºå¤šç§ç»“æ„ç±»å‹ï¼Œé€šå¸¸åˆ†ä¸ºä¸¤ç±»ï¼šé¢„æ£€ç´¢åˆ†æ”¯æ¨¡å¼ã€åæ£€ç´¢åˆ†æ”¯æ¨¡å¼ã€‚</p><h3 id="é¢„æ£€ç´¢åˆ†æ”¯-Pre-Retrieval-Branching"><a href="#é¢„æ£€ç´¢åˆ†æ”¯-Pre-Retrieval-Branching" class="headerlink" title="é¢„æ£€ç´¢åˆ†æ”¯(Pre-Retrieval Branching)"></a>é¢„æ£€ç´¢åˆ†æ”¯(Pre-Retrieval Branching)</h3><p>æ˜¯ä¸€ç§é€šè¿‡ç”Ÿæˆå¤šä¸ª<strong>å­æŸ¥è¯¢å¹¶è¡Œæ£€ç´¢</strong>çš„æ¨¡å¼ï¼Œç”¨äºæé«˜æ£€ç´¢çš„å…¨é¢æ€§å’Œç”Ÿæˆç»“æœçš„å¤šæ ·æ€§ã€‚</p><p><img src="/2025/08/21/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/6.png" alt="é¢„æ£€ç´¢åˆ†æ”¯æµç¨‹"></p><h3 id="åæ£€ç´¢åˆ†æ”¯-Post-Retrieval-Branching"><a href="#åæ£€ç´¢åˆ†æ”¯-Post-Retrieval-Branching" class="headerlink" title="åæ£€ç´¢åˆ†æ”¯(Post-Retrieval Branching)"></a>åæ£€ç´¢åˆ†æ”¯(Post-Retrieval Branching)</h3><p>è¯¥æ¨¡å¼ä»<strong>å•ä¸€æŸ¥è¯¢</strong>å¼€å§‹ï¼Œé€šè¿‡<strong>æ£€ç´¢æ¨¡å—</strong>è·å–å¤šä¸ªæ–‡æ¡£å—ã€‚æ¯ä¸ªæ–‡æ¡£å—è¢«ç‹¬ç«‹é€å…¥ç”Ÿæˆæ¨¡å—è¿›è¡Œå¤„ç†ï¼Œç”Ÿæˆå¯¹åº”çš„ç»“æœé›†åˆã€‚éšåï¼Œè¿™äº›ç”Ÿæˆçš„ç»“æœé€šè¿‡åˆå¹¶æ¨¡å—è¿›è¡Œæ•´åˆï¼Œå½¢æˆæœ€ç»ˆç»“æœã€‚</p><p><img src="/2025/08/21/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/7.png" alt="åæ£€ç´¢åˆ†æ”¯æµç¨‹"></p><h3 id="å¾ªç¯æ¨¡å¼"><a href="#å¾ªç¯æ¨¡å¼" class="headerlink" title="å¾ªç¯æ¨¡å¼"></a>å¾ªç¯æ¨¡å¼</h3><p>å¾ªç¯æ¨¡å¼çš„æ ¸å¿ƒæ˜¯æ£€ç´¢ä¸ç”Ÿæˆæ­¥éª¤ä¹‹é—´çš„<strong>ç›¸äº’ä¾èµ–æ€§</strong>ã€‚å¾ªç¯æ¨¡å¼é€šè¿‡å¼•å…¥è°ƒåº¦æ¨¡å—è¿›è¡Œæ§åˆ¶ï¼Œç¡®ä¿ç³»ç»Ÿå¯ä»¥æ ¹æ®éœ€è¦åœ¨ç‰¹å®šæ¨¡å—ä¹‹é—´<strong>é‡å¤æ‰§è¡Œ</strong>æŸäº›æ“ä½œã€‚</p><p>å¾ªç¯æ¨¡å¼çš„å…³é”®åœ¨äº<strong>åˆ¤æ–­æ¨¡å—</strong>ï¼ˆJudge Moduleï¼‰ï¼Œç”¨äºå†³å®šæµç¨‹æ˜¯å¦éœ€è¦è¿”å›åˆ°ä¹‹å‰çš„æ¨¡å—æˆ–ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚</p><p>å¾ªç¯æ¨¡å¼å¯ä»¥è¿›ä¸€æ­¥ç»†åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼šè¿­ä»£å‹ã€é€’å½’å‹å’Œè‡ªé€‚åº”å‹ï¼ˆä¸»åŠ¨å‹ï¼‰æ£€ç´¢æ¨¡å¼ã€‚</p><ol><li>è¿­ä»£å‹å¾ªç¯æ¨¡å¼ï¼šé€šè¿‡å¤šæ¬¡å¾ªç¯æ‰§è¡Œ<strong>æ£€ç´¢</strong>å’Œ<strong>ç”Ÿæˆ</strong>æ“ä½œï¼Œåœ¨æ¯æ¬¡è¿­ä»£ä¸­é€æ­¥ä¼˜åŒ–ç»“æœã€‚åœ¨æ¯ä¸€æ­¥è¿­ä»£ä¸­ï¼Œç³»ç»Ÿæ ¹æ®å½“å‰æŸ¥è¯¢å’Œä¹‹å‰çš„è¾“å‡ºç»“æœï¼Œæ£€ç´¢ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µï¼Œç„¶ååˆ©ç”¨è¿™äº›æ–‡æ¡£ç”Ÿæˆæ–°çš„è¾“å‡ºã€‚è¿­ä»£è¿‡ç¨‹é€šå¸¸è®¾ç½®ä¸€ä¸ª<strong>æœ€å¤§è¿­ä»£æ¬¡æ•°</strong>çš„é™åˆ¶ï¼Œä»¥é¿å…æ— é™å¾ªç¯ã€‚</li></ol><p><img src="/2025/08/21/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/8.png" alt="è¿­ä»£å‹å¾ªç¯æ¨¡å¼"></p><ol start="2"><li>é€’å½’å‹å¾ªç¯æ£€ç´¢æ¨¡å¼ï¼šä¸€ç§å…·æœ‰æ˜æ˜¾<strong>ä¾èµ–æ€§</strong>å’Œ<strong>å±‚æ¬¡æ€§</strong>çš„æ£€ç´¢æ–¹å¼ã€‚å…¶æ˜¾è‘—ç‰¹ç‚¹åœ¨äºæ¯ä¸€æ­¥éƒ½ä¾èµ–äºå‰ä¸€æ­¥çš„è¾“å‡ºï¼Œå¹¶é€šè¿‡ä¸æ–­åŠ æ·±æ£€ç´¢è¿‡ç¨‹ï¼Œé€æ­¥æŒ–æ˜æ›´æ·±å±‚æ¬¡çš„ä¿¡æ¯ã€‚é€’å½’å‹æ£€ç´¢è¿˜åŒ…å«æ˜ç¡®çš„<strong>é€€å‡ºæœºåˆ¶</strong>ï¼Œç”¨ä»¥ç¡®ä¿åœ¨æ»¡è¶³ç»ˆæ­¢æ¡ä»¶æ—¶æµç¨‹ç»ˆæ­¢ï¼Œé¿å…æ— é™é€’å½’ã€‚é€’å½’å‹å¾ªç¯æ¨¡å¼é€šè¿‡æŸ¥è¯¢è½¬æ¢æ¨¡å—ç”Ÿæˆæ–°çš„æŸ¥è¯¢ï¼Œä»¥æ¨åŠ¨æ£€ç´¢é€å±‚æ·±å…¥ã€‚</li></ol><p><img src="/2025/08/21/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/9.png" alt="é€’å½’å‹å¾ªç¯æ£€ç´¢æ¨¡å¼"></p><ol start="3"><li><p>è‡ªé€‚åº”å‹ï¼ˆä¸»åŠ¨å‹ï¼‰æ¨¡å¼ï¼šæ˜¯ä¸€ç§è¶…è¶Šä¼ ç»Ÿè¢«åŠ¨æ£€ç´¢æ¨¡å¼çš„æ–°å…´æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³ç±»ä¼¼äºå¤§è¯­è¨€æ¨¡å‹æ™ºèƒ½ä½“ï¼Œé€šè¿‡<strong>åŠ¨æ€è°ƒæ•´æ£€ç´¢æµç¨‹</strong>ï¼Œä¸»åŠ¨å†³å®šä½•æ—¶è¿›è¡Œæ£€ç´¢ä»¥åŠä½•æ—¶ç»ˆæ­¢æµç¨‹å¹¶ç”Ÿæˆæœ€ç»ˆç»“æœã€‚  </p><p> è‡ªé€‚åº”å‹æ£€ç´¢é€šå¸¸æ ¹æ®åˆ¤æ–­æ ‡å‡†è¿›ä¸€æ­¥ç»†åˆ†ä¸ºä¸¤ç§æ–¹æ³•ï¼šåŸºäºæç¤ºçš„æ–¹æ³•å’ŒåŸºäºæŒ‡ä»¤å¾®è°ƒçš„æ–¹æ³•ã€‚</p><ol><li>åŸºäºæç¤ºçš„æ–¹æ³•ï¼šé€šè¿‡<strong>è®¾è®¡åŠ¨æ€æç¤º</strong>å¯¹æ¨¡å‹è¿›è¡Œå¼•å¯¼ï¼›</li><li>åŸºäºæŒ‡ä»¤å¾®è°ƒçš„æ–¹æ³•ï¼šåˆ©ç”¨<strong>æŒ‡ä»¤å¾®è°ƒ</strong>çš„æ–¹æ³•å®ç°æ›´ç²¾å‡†çš„æ£€ç´¢æ§åˆ¶ã€‚</li></ol></li></ol><p><img src="/2025/08/21/%E3%80%8A%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AE%9E%E8%B7%B5%E3%80%8BRAG%E7%AB%A0%E8%8A%82%E7%AC%94%E8%AE%B0/10.png" alt="è‡ªé€‚åº”å‹ï¼ˆä¸»åŠ¨å‹ï¼‰æ¨¡å¼"></p><h2 id="RAGç³»ç»Ÿè®­ç»ƒä¸ä¼˜åŒ–"><a href="#RAGç³»ç»Ÿè®­ç»ƒä¸ä¼˜åŒ–" class="headerlink" title="RAGç³»ç»Ÿè®­ç»ƒä¸ä¼˜åŒ–"></a>RAGç³»ç»Ÿè®­ç»ƒä¸ä¼˜åŒ–</h2><h3 id="æ–‡æœ¬åµŒå…¥æ¨¡å‹å¾®è°ƒ"><a href="#æ–‡æœ¬åµŒå…¥æ¨¡å‹å¾®è°ƒ" class="headerlink" title="æ–‡æœ¬åµŒå…¥æ¨¡å‹å¾®è°ƒ"></a>æ–‡æœ¬åµŒå…¥æ¨¡å‹å¾®è°ƒ</h3><p>æ–‡æœ¬åµŒå…¥ï¼ˆText Embeddingï¼‰æ˜¯ä¸€ç§å°†æ–‡æœ¬è½¬æ¢ä¸ºå›ºå®šç»´åº¦å‘é‡ï¼ˆé€šå¸¸æ˜¯é«˜ç»´æµ®ç‚¹æ•°ç»„ï¼‰çš„æŠ€æœ¯ï¼Œæ—¨åœ¨ä»¥æ•°å­¦å½¢å¼æ•æ‰è¯­è¨€çš„è¯­ä¹‰ä¿¡æ¯ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ°å‘é‡ç©ºé—´ä¸­ã€‚åœ¨RAGç³»ç»Ÿä¸­ï¼Œæ–‡æœ¬åµŒå…¥è¡¨ç¤ºæ˜¯<strong>å®ç°å‘é‡æœç´¢</strong>çš„æ ¸å¿ƒæŠ€æœ¯ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>LLM</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Redisé¡¹ç›®åŠåŸç†æ€»ç»“</title>
    <link href="/2025/08/20/Redis%E9%A1%B9%E7%9B%AE%E5%8F%8A%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/"/>
    <url>/2025/08/20/Redis%E9%A1%B9%E7%9B%AE%E5%8F%8A%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1 id="Redisé¡¹ç›®åŠåŸç†æ€»ç»“"><a href="#Redisé¡¹ç›®åŠåŸç†æ€»ç»“" class="headerlink" title="Redisé¡¹ç›®åŠåŸç†æ€»ç»“"></a>Redisé¡¹ç›®åŠåŸç†æ€»ç»“</h1><h2 id="1-RedisåŸºç¡€"><a href="#1-RedisåŸºç¡€" class="headerlink" title="1. RedisåŸºç¡€"></a>1. RedisåŸºç¡€</h2><p>Redisæ˜¯ä¸€ç§<strong>NoSQL</strong>æ•°æ®åº“ï¼Œé‡‡ç”¨å†…å­˜å­˜å‚¨ï¼Œè¯»å†™é€Ÿåº¦è¿œè¶…ç£ç›˜å­˜å‚¨çš„SQLæ•°æ®åº“ï¼Œé€‚åˆäºåˆ†å¸ƒå¼è®¾è®¡ï¼Œæ–¹ä¾¿è¿›è¡Œæ‰©å®¹ï¼Œæä¾›è¿‡æœŸæ—¶é—´ï¼Œå‘å¸ƒè®¢é˜…ï¼Œluaè„šæœ¬ç­‰åŠŸèƒ½ã€‚</p><p><img src="/2025/08/20/Redis%E9%A1%B9%E7%9B%AE%E5%8F%8A%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/nosql.png" alt="SQL vs NoSQL" title="SQLä¸NoSQLçš„å¯¹æ¯”"></p><p>Redisæä¾›ä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼Œå¸¸è§çš„5ç§æ•°æ®ç±»å‹ä¸ºï¼š<strong>String(å­—ç¬¦ä¸²)ï¼ŒHash(å“ˆå¸Œ)ï¼ŒList(åˆ—è¡¨)ï¼ŒSet(é›†åˆ)ï¼ŒZset(æœ‰åºé›†åˆ)</strong>ã€‚éšç€ç‰ˆæœ¬æ›´æ–°ï¼Œåé¢åˆæ–°å¢æ”¯æŒäº†å››ç§æ•°æ®ç±»å‹ï¼š<strong>BitMap(ä½å›¾)ï¼ŒHyperLogLog(è¶…æ—¥å¿—)ï¼ŒGEO(åœ°ç†ç©ºé—´)ï¼ŒStream(æµ)</strong> ã€‚è¿™äº›æ•°æ®ç±»å‹åœ¨åé¢çš„é¡¹ç›®ä¸­éƒ½æœ‰åº”ç”¨åˆ°ï¼Œæ¦‚æ‹¬æ¥è¯´ï¼Œä»–ä»¬çš„åº”ç”¨åœºæ™¯ä¸ºï¼š</p><ul><li>Stringç±»å‹ï¼šç¼“å­˜å¯¹è±¡ï¼Œå…±äº«sessionï¼Œå¸¸è§„è®¡æ•°ç­‰ </li><li>Hashç±»å‹ï¼šç¼“å­˜å¯¹è±¡ï¼Œå¯ä»¥åªä¿®æ”¹æŸä¸€é¡¹å±æ€§å€¼</li><li>Listç±»å‹ï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä½†æ³¨æ„åªæ”¯æŒå•æ¶ˆè´¹è€…</li><li>Setç±»å‹ï¼šå…±åŒå¥½å‹ï¼Œèšåˆè®¡ç®—ï¼ˆæ±‚äº¤é›†ï¼Œå¹¶é›†ï¼‰</li><li>Zsetç±»å‹ï¼šæ’åºåœºæ™¯ï¼Œä¾‹å¦‚æ’è¡Œæ¦œ</li><li>BitMapç±»å‹ï¼šäºŒå€¼çŠ¶æ€ç»Ÿè®¡åœºæ™¯ï¼Œæ¯”å¦‚ç­¾åˆ°è¡¨</li><li>HyperLogLogç±»å‹ï¼šæµ·é‡æ•°æ®åŸºæ•°ç»Ÿè®¡ï¼Œæ¯”å¦‚ç™¾ä¸‡çº§UVç»Ÿè®¡</li><li>GEOç±»å‹ï¼šå­˜å‚¨åœ°ç†ä½ç½®ä¿¡æ¯åœºæ™¯ï¼Œæ¯”å¦‚é™„è¿‘å•†æˆ·</li><li>Streamç±»å‹ï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæä¾›æ¶ˆè´¹è€…ç»„æ¨¡å¼</li></ul><p>Rediså‘½ä»¤ï¼Œè¯¦è§<a href="https://www.runoob.com/redis/redis-commands.html">èœé¸Ÿæ•™ç¨‹Rediså‘½ä»¤</a>ã€‚</p><h2 id="2-Redisé¡¹ç›®â€”â€”é»‘é©¬ç‚¹è¯„"><a href="#2-Redisé¡¹ç›®â€”â€”é»‘é©¬ç‚¹è¯„" class="headerlink" title="2. Redisé¡¹ç›®â€”â€”é»‘é©¬ç‚¹è¯„"></a>2. Redisé¡¹ç›®â€”â€”é»‘é©¬ç‚¹è¯„</h2><h3 id="2-1-çŸ­ä¿¡éªŒè¯ç ç™»å½•"><a href="#2-1-çŸ­ä¿¡éªŒè¯ç ç™»å½•" class="headerlink" title="2.1 çŸ­ä¿¡éªŒè¯ç ç™»å½•"></a>2.1 çŸ­ä¿¡éªŒè¯ç ç™»å½•</h3><h4 id="åŸºäºSessionå®ç°ç™»å½•"><a href="#åŸºäºSessionå®ç°ç™»å½•" class="headerlink" title="åŸºäºSessionå®ç°ç™»å½•"></a>åŸºäºSessionå®ç°ç™»å½•</h4><p>ä¸šåŠ¡æµç¨‹ï¼š  </p><ol><li>å‘é€çŸ­ä¿¡éªŒè¯ç </li><li>çŸ­ä¿¡éªŒè¯ç ç™»å½•ã€æ³¨å†Œ</li><li>æ ¡éªŒç™»å½•çŠ¶æ€<br><img src="/2025/08/20/Redis%E9%A1%B9%E7%9B%AE%E5%8F%8A%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/login_basesession.png" alt="sessionç™»å½•æµç¨‹" title="åŸºäºsessionç™»å½•æµç¨‹"></li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li><strong>æ°´å¹³æ‰©å±•å›°éš¾</strong>ï¼šå¦‚æœæœ‰å¤šå°tomcatæœåŠ¡å™¨ï¼Œsessionä¸ä¾¿äºæ°´å¹³æ‰©å±•ï¼Œå› ä¸ºsessionå­˜å‚¨åœ¨å•ä¸ªæœåŠ¡å™¨çš„å†…å­˜ä¸­ï¼Œç”¨æˆ·è¯·æ±‚å¿…é¡»å§‹ç»ˆè·¯ç”±åˆ°åŒä¸€å°æœåŠ¡å™¨æ‰èƒ½å¾—åˆ°æ­£ç¡®çš„æ•°æ®</li><li><strong>éªŒè¯ç çŠ¶æ€ç®¡ç†ä¸çµæ´»</strong>ï¼šSessionä¼šéšç€ä¼šè¯ç»“æŸè€Œå¤±æ•ˆï¼Œä½†çŸ­ä¿¡éªŒè¯ç éœ€è¦æ›´çŸ­çš„æœ‰æ•ˆæœŸï¼Œéœ€è¦é¢å¤–é€»è¾‘ç®¡ç†éªŒè¯ç è¿‡æœŸæ—¶é—´</li></ol><h4 id="åŸºäºRediså®ç°ç™»å½•"><a href="#åŸºäºRediså®ç°ç™»å½•" class="headerlink" title="åŸºäºRediså®ç°ç™»å½•"></a>åŸºäºRediså®ç°ç™»å½•</h4><p>ä¸¤ä¸ªåœ°æ–¹éœ€è¦ç”¨Redisæ¥è¿›è¡Œæ•°æ®ç¼“å­˜ï¼š</p><ol><li>éªŒè¯ç ï¼ˆç”ŸæˆéªŒè¯ç -æ ¡éªŒéªŒè¯ç ï¼‰ï¼›</li><li>ç”¨æˆ·ä¿¡æ¯ï¼ˆç™»å½•ç”¨æˆ·-ç”¨æˆ·ç™»å½•çŠ¶æ€æ ¡éªŒï¼‰ã€‚</li></ol><p>å¦‚ä½•é€‰æ‹©keyå’Œvalueï¼Ÿæ˜ç¡®keyçš„è¦æ±‚ï¼šå”¯ä¸€æ€§ï¼Œæ–¹ä¾¿æºå¸¦å’Œæå–ã€‚  </p><ol><li>éªŒè¯ç ï¼š<ol><li>key-è®¾ç½®ä¸ºæ‰‹æœºå·ï¼Œæ–¹ä¾¿å®¢æˆ·ç«¯å–å‡ºä¿¡æ¯è¿›è¡ŒéªŒè¯ï¼ˆåŸæ¥åŸºäºSessionå®ç°ï¼Œå®¢æˆ·ç«¯é€šè¿‡Cookieæºå¸¦SessionIdæ¥è‡ªåŠ¨å–å‡ºï¼‰ï¼›</li><li>value-éªŒè¯ç ï¼Œæ•°æ®ç±»å‹é€‰æ‹©ä¸ºæœ€ç®€å•çš„Stringå°±å¯ä»¥å®ç°</li></ol></li><li>ç”¨æˆ·ä¿¡æ¯ï¼š<ol><li>key-è®¾ç½®ä¸ºéšæœºtokenä½œä¸ºç™»å½•å‡­è¯ï¼ˆè¿™é‡Œä¸ç”¨æ‰‹æœºå·çš„åŸå› æ˜¯æ‰‹æœºå·ä½œä¸ºç™»å½•å‡­è¯è¿”å›ç»™å‰ç«¯ä¸å®‰å…¨ï¼‰ï¼›</li><li>value-ç”¨æˆ·ä¿¡æ¯ï¼Œæœ‰ä¸¤ç§æ•°æ®ç±»å‹å¯ä»¥é€‰æ‹©ï¼Œä¸€æ˜¯é‡‡ç”¨Stringç±»å‹ï¼Œä»¥JSONå­—ç¬¦ä¸²å­˜å‚¨ï¼Œé€‚åˆç”¨æˆ·ä¿¡æ¯è¾ƒå°‘çš„æƒ…å†µï¼Œè€¦åˆæ€§è¾ƒé«˜ã€‚äºŒæ˜¯é‡‡ç”¨Hashç±»å‹ï¼Œfieldå°±æ˜¯ç”¨æˆ·å±æ€§ï¼Œvalueå°±æ˜¯å±æ€§å€¼</li></ol></li></ol><p>ä¸šåŠ¡æµç¨‹ï¼š</p><p>æ€»ä½“æµç¨‹ä¸åŸºäºsessionç™»å½•ç±»ä¼¼ï¼Œä¸åŒç‚¹åœ¨äºéªŒè¯ç å’Œç”¨æˆ·çŠ¶æ€éœ€è¦ç¼“å­˜åœ¨redisä¸­ï¼Œç„¶ååœ¨æ ¡éªŒæ—¶ï¼Œéœ€ä»redisä¸­è¯»å–éªŒè¯</p><p><img src="/2025/08/20/Redis%E9%A1%B9%E7%9B%AE%E5%8F%8A%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/redislogin.png" alt="redisç™»å½•æµç¨‹1" title="åŸºäºredisç™»å½•æµç¨‹1">  </p><p><img src="/2025/08/20/Redis%E9%A1%B9%E7%9B%AE%E5%8F%8A%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/redislogin2.png" alt="redisç™»å½•æµç¨‹2" title="åŸºäºredisç™»å½•æµç¨‹2">  </p><p>ä»£ç å®ç°ï¼š</p><ol><li>å‘é€çŸ­ä¿¡éªŒè¯ç ï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> Result <span class="hljs-title function_">sendCode</span><span class="hljs-params">(String phone, HttpSession session)</span> &#123;<br>    <span class="hljs-comment">//1. æ ¡éªŒæ‰‹æœºå·</span><br>    <span class="hljs-keyword">if</span>(RegexUtils.isPhoneInvalid(phone))&#123;<br>        <span class="hljs-comment">//2. å¦‚æœä¸ç¬¦åˆï¼Œè¿”å›é”™è¯¯ä¿¡æ¯</span><br>        <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">&quot;æ‰‹æœºå·æ ¼å¼é”™è¯¯ï¼&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">//3. ç¬¦åˆï¼Œç”ŸæˆéªŒè¯ç </span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">code</span> <span class="hljs-operator">=</span> RandomUtil.randomNumbers(<span class="hljs-number">6</span>);<br>    <span class="hljs-comment">//4. ä¿å­˜éªŒè¯ç åˆ°redis</span><br>    stringRedisTemplate.opsForValue().set(LOGIN_CODE_KEY + phone, code,LOGIN_CODE_TTL, TimeUnit.MINUTES);<br>    <span class="hljs-comment">//5. å‘é€éªŒè¯ç </span><br>    log.debug(<span class="hljs-string">&quot;å‘é€çŸ­ä¿¡éªŒè¯ç æˆåŠŸï¼ŒéªŒè¯ç ä¸ºï¼š&quot;</span> + code);<br>    <span class="hljs-comment">// è¿”å›ok</span><br>    <span class="hljs-keyword">return</span> Result.ok();<br>&#125;<br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼šæ­¤å¤„éªŒè¯ç å‘é€åŠŸèƒ½ä»…å®ç°æ¨¡æ‹Ÿï¼Œåç»­å°†ä½¿ç”¨è…¾è®¯äº‘æä¾›çš„çŸ­ä¿¡æœåŠ¡å®ç°çœŸå®åœ°çŸ­ä¿¡å‘é€åŠŸèƒ½</p><ol start="2"><li>æ ¹æ®éªŒè¯ç è¿›è¡Œç™»å½•&#x2F;æ³¨å†Œ</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs java">   <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">login</span><span class="hljs-params">(LoginFormDTO loginForm, HttpSession session)</span> &#123;<br>        <span class="hljs-comment">//1.æ ¡éªŒæ‰‹æœºå·</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">phone</span> <span class="hljs-operator">=</span> loginForm.getPhone();<br>        <span class="hljs-keyword">if</span>(RegexUtils.isPhoneInvalid(phone))&#123;<br>            <span class="hljs-comment">//2. å¦‚æœä¸ç¬¦åˆï¼Œè¿”å›é”™è¯¯ä¿¡æ¯</span><br>            <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">&quot;æ‰‹æœºå·æ ¼å¼é”™è¯¯ï¼&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-comment">//3. ä»redisä¸­è·å–éªŒè¯ç å¹¶æ ¡éªŒ</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">cachCode</span> <span class="hljs-operator">=</span> stringRedisTemplate.opsForValue().get(LOGIN_CODE_KEY + phone);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">code</span> <span class="hljs-operator">=</span> loginForm.getCode();<br>        <span class="hljs-keyword">if</span>(cachCode == <span class="hljs-literal">null</span> || !cachCode.equals(code))&#123;<br>            <span class="hljs-comment">//ä¸ä¸€è‡´ï¼ŒæŠ¥é”™</span><br>            <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">&quot;éªŒè¯ç é”™è¯¯&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-comment">//4. ä¸€è‡´ï¼Œæ ¹æ®æ‰‹æœºå·æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ select * from tb_user where phone= ? ç”¨mybatisplusæ¥å®ç°</span><br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> query().eq(<span class="hljs-string">&quot;phone&quot;</span>, phone).one();<br>        <span class="hljs-comment">//query ç›¸å½“äº select * from tb_userï¼›eq ç›¸å½“äº = ;  æŸ¥å¤šä¸ªç»“æœå°±æ˜¯list() ; æŸ¥ä¸€ä¸ªç»“æœå°±æ˜¯one();</span><br><br>        <span class="hljs-comment">//5. åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨</span><br>        <span class="hljs-keyword">if</span>(user == <span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-comment">//6. ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°ç”¨æˆ·ï¼Œå¹¶ä¿å­˜åˆ°æ•°æ®åº“</span><br>            <span class="hljs-comment">// æ³¨æ„è¿˜éœ€è¦è¿”å›è¿™ä¸ªåˆ›å»ºçš„ç”¨æˆ·ï¼Œå› ä¸ºåé¢éœ€è¦ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°session</span><br>            user = createUserWithPhone(phone);<br>        &#125;<br><br>        <span class="hljs-comment">//7. ç”¨æˆ·å­˜åœ¨ï¼Œä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°redisä¸­ï¼š</span><br>        <span class="hljs-comment">// 7.1 ç”Ÿæˆéšæœºtokenä½œä¸ºç™»å½•ä»¤ç‰Œå’Œkey</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> UUID.randomUUID().toString(<span class="hljs-literal">true</span>);<br>        <span class="hljs-comment">// 7.2 å°†userå¯¹è±¡è½¬æ¢ä¸ºhashå­˜å‚¨åˆ°valueä¸­â€”â€”â€”â€”å…ˆè½¬æˆmap&lt;hashkey,value&gt;ï¼Œå†ç”¨putallä¸€æ¬¡æ€§å­˜å…¥ï¼Œä¸ç„¶è¦å¤šæ¬¡äº¤äº’ï¼Œå¾ˆéº»çƒ¦</span><br>        <span class="hljs-type">UserDTO</span> <span class="hljs-variable">userDTO</span> <span class="hljs-operator">=</span> BeanUtil.copyProperties(user, UserDTO.class);<br>        <span class="hljs-comment">// ç”±äºuserDTOå¯¹è±¡ä¸­çš„idæ˜¯longç±»å‹çš„ï¼Œåœ¨ä¿å­˜ä¿¡æ¯çš„æ—¶å€™mapä¸­çš„&lt;id,991&gt;ä¸­çš„valueæ˜¯longç±»å‹ï¼Œè€ŒstringRedisTemplateè¦æ±‚ä¸ºStringç±»å‹ï¼Œæ‰€ä»¥éœ€è¦è½¬æ¢</span><br>        Map&lt;String, Object&gt; userMap = BeanUtil.beanToMap(<br>                userDTO,<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;(),<br>                CopyOptions.create()<br>                .setIgnoreNullValue(<span class="hljs-literal">true</span>) <span class="hljs-comment">// å¿½ç•¥å€¼ä¸º null çš„å­—æ®µ</span><br>                .setFieldValueEditor((fieldName, fieldValue) -&gt; fieldValue.toString()) <span class="hljs-comment">// å­—æ®µå€¼å¤„ç†å™¨ï¼Œå¤„ç†longå‹çš„idå€¼</span><br>        );<br>        <span class="hljs-comment">// 7.3 ä¿å­˜ä¿¡æ¯</span><br>        stringRedisTemplate.opsForHash().putAll(LOGIN_USER_KEY + token, userMap);<br>        <span class="hljs-comment">// 7.4 è®¾ç½®tokenæœ‰æ•ˆæœŸï¼Œå¹¶é€šè¿‡æ‹¦æˆªå™¨æ›´æ–°tokenæœ‰æ•ˆæœŸ</span><br>        stringRedisTemplate.expire(LOGIN_USER_KEY + token, LOGIN_USER_TTL, TimeUnit.MINUTES);<br><br>        <span class="hljs-comment">//8. è¿”å›tokenç»™å‰ç«¯</span><br>        <span class="hljs-keyword">return</span> Result.ok(token);<br>    &#125;<br>```  <br><br><span class="hljs-number">3.</span> æ ¡éªŒç™»å½•çŠ¶æ€<br>  <br>é€šè¿‡ä¸¤ä¸ªæ‹¦æˆªå™¨æ¥å®ç°ï¼Œä¸€ä¸ªtokenåˆ·æ–°æ‹¦æˆªå™¨ï¼Œä¸€ä¸ªloginæ‹¦æˆªå™¨ã€‚<br><br>ä¸è®¾ç½®æˆä¸€ä¸ªæ‹¦æˆªå™¨çš„åŸå› æ˜¯ï¼Œå¦‚æœæŠŠtokenåˆ·æ–°é€»è¾‘ä¹Ÿæ”¾åœ¨loginæ‹¦æˆªå™¨ä¸­ï¼Œä¼šå‡ºç°ä¸€ä¸ªæƒ…å†µï¼šå·²ç»ç™»å½•çš„ç”¨æˆ·è®¿é—®é‚£äº›æ— éœ€ç™»å½•æƒé™çš„é¡µé¢æ—¶ï¼Œä¸ä¼šè§¦å‘tokenåˆ·æ–°ï¼Œå¯èƒ½å¯¼è‡´æ´»è·ƒçš„ç™»å½•ç”¨æˆ·çªç„¶è¦æ±‚å†æ¬¡ç™»å½•ï¼Œè¿™ä¸ç¬¦åˆä¸šåŠ¡éœ€æ±‚ã€‚<br><br>æ³¨å†Œæ‹¦æˆªå™¨ï¼š<br><br>```java<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> &#123;<br>        <span class="hljs-comment">//ç™»å½•æ‹¦æˆªå™¨ï¼šæŒ‡å®šä¸ç”¨æ‹¦æˆªçš„è·¯å¾„</span><br>        registry.addInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LoginInterceptor</span>())<br>                .excludePathPatterns(<br>                <span class="hljs-string">&quot;/user/code&quot;</span>,<br>                <span class="hljs-string">&quot;/user/login&quot;</span>,<br>                <span class="hljs-string">&quot;/blog/hot&quot;</span>,<br>                <span class="hljs-string">&quot;/shop/**&quot;</span>,<br>                <span class="hljs-string">&quot;/shop-type/**&quot;</span>,<br>                <span class="hljs-string">&quot;/upload/**&quot;</span>,<br>                <span class="hljs-string">&quot;/voucher/**&quot;</span><br>        ).order(<span class="hljs-number">1</span>);<br>        <span class="hljs-comment">//tokenåˆ·æ–°æ‹¦æˆªå™¨</span><br>        registry.addInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RefreshTokenInterceptor</span>(stringRedisTemplate)).addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>).order(<span class="hljs-number">0</span>); <br>        <span class="hljs-comment">//æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œå¹¶ä¸”æœ€å…ˆæ‰§è¡Œï¼Œé€šè¿‡orderæŒ‡å®šæ‹¦æˆªå™¨çš„é¡ºåº</span><br>    &#125;<br></code></pre></td></tr></table></figure><p>tokenåˆ·æ–°æ‹¦æˆªå™¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å‰ç½®æ‹¦æˆªï¼Œåœ¨controlleræ‰§è¡Œä¹‹å‰å»å®Œæˆâ€”â€”å»åšç”¨æˆ·ä¿¡æ¯æ ¡éªŒ</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>    <span class="hljs-comment">//1. è·å–è¯·æ±‚å¤´ä¸­çš„token</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> request.getHeader(<span class="hljs-string">&quot;authorization&quot;</span>);<br>    <span class="hljs-keyword">if</span>(StrUtil.isBlank(token))&#123;<br>        <span class="hljs-comment">//tokenä¸ºç©ºï¼Œæ”¾è¡Œåˆ°loginInterceptorè¿›è¡Œè·¯å¾„æ‹¦æˆªæ ¡éªŒ</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-comment">//2. åŸºäºtokenè·å–redisä¸­çš„ç”¨æˆ·</span><br>    <span class="hljs-comment">// æ³¨æ„ä¸æ˜¯ç”¨getï¼ˆkey,filedï¼‰,å®ƒè¿”å›çš„åªæ˜¯keyä¸­æŸä¸ªhashkeyçš„valueï¼Œè¦ç”¨entriesï¼Œè·å–map&lt;&gt;</span><br>    Map&lt;Object, Object&gt; userMap = stringRedisTemplate.opsForHash().entries(RedisConstants.LOGIN_USER_KEY + token);<br>    <span class="hljs-comment">// 3. åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨</span><br>    <span class="hljs-keyword">if</span>(userMap.isEmpty())&#123;<br>        <span class="hljs-comment">// 4. ä¸å­˜åœ¨ï¼Œæ”¾è¡Œåˆ°loginInterceptorè¿›è¡Œè·¯å¾„æ‹¦æˆªæ ¡éªŒ</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-comment">//5. å­˜åœ¨ï¼Œå°†redisä¸­è·å–çš„hashæ•°æ®è½¬æ¢æˆUserDTOå¯¹è±¡,ä¸å¿½ç•¥é”™è¯¯</span><br>    <span class="hljs-type">UserDTO</span> <span class="hljs-variable">userDTO</span> <span class="hljs-operator">=</span> BeanUtil.fillBeanWithMap(userMap, <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDTO</span>(), <span class="hljs-literal">false</span>);<br>    <span class="hljs-comment">// 6. ä¿å­˜åˆ°å½“å‰çº¿ç¨‹ä¸­</span><br>    UserHolder.saveUser(userDTO);<br>    <span class="hljs-comment">// 7. åˆ·æ–°tokenæœ‰æ•ˆæœŸ</span><br>    stringRedisTemplate.expire(RedisConstants.LOGIN_USER_KEY + token,RedisConstants.LOGIN_USER_TTL, TimeUnit.MINUTES);<br>    <span class="hljs-comment">// 8. æ”¾è¡Œ</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-comment">//åœ¨è§†å›¾æ¸²æŸ“åæ‹¦æˆªï¼Œè¿”å›ç»™ç”¨æˆ·ä¹‹å‰â€”â€”é”€æ¯ç”¨æˆ·ä¿¡æ¯ï¼Œé¿å…å†…å­˜æ³„éœ²</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>    <span class="hljs-comment">// ç§»é™¤ç”¨æˆ·</span><br>    UserHolder.removeUser();<br>&#125;<br><br></code></pre></td></tr></table></figure><p>loginæ‹¦æˆªå™¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å‰ç½®æ‹¦æˆªï¼Œåœ¨controlleræ‰§è¡Œä¹‹å‰å»å®Œæˆâ€”â€”å»åšç”¨æˆ·ä¿¡æ¯æ ¡éªŒ</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>    <span class="hljs-comment">// 1. åˆ¤æ–­æ˜¯å¦éœ€è¦æ‹¦æˆªï¼ˆthreadlocalä¸­æ˜¯å¦æœ‰ç”¨æˆ·â€”â€”æ ¡éªŒç™»å½•çŠ¶æ€ï¼‰</span><br>    <span class="hljs-keyword">if</span>(UserHolder.getUser() == <span class="hljs-literal">null</span>)&#123;<br>        <span class="hljs-comment">// æ²¡æœ‰ç™»å½•çŠ¶æ€ï¼Œæ‹¦æˆª</span><br>        response.setStatus(<span class="hljs-number">401</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-comment">// æœ‰ç”¨æˆ·ï¼Œæ”¾è¡Œ</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-1-å•†é“ºæŸ¥è¯¢ç¼“å­˜"><a href="#2-1-å•†é“ºæŸ¥è¯¢ç¼“å­˜" class="headerlink" title="2.1 å•†é“ºæŸ¥è¯¢ç¼“å­˜"></a>2.1 å•†é“ºæŸ¥è¯¢ç¼“å­˜</h3><h4 id="ç¼“å­˜çš„æ„ä¹‰"><a href="#ç¼“å­˜çš„æ„ä¹‰" class="headerlink" title="ç¼“å­˜çš„æ„ä¹‰"></a>ç¼“å­˜çš„æ„ä¹‰</h4><p>ç¼“å­˜çš„æ ¸å¿ƒä½œç”¨æ˜¯<strong>æé«˜æ€§èƒ½ã€å‡è½»æ•°æ®åº“å‹åŠ›ã€æ”¹å–„ç”¨æˆ·ä½“éªŒ</strong>ã€‚å®ƒçš„é€‚ç”¨åœºæ™¯åŒ…æ‹¬<strong>çƒ­ç‚¹æ•°æ®é¢‘ç¹è®¿é—®ã€æ•°æ®å˜åŒ–ä¸é¢‘ç¹ã€åˆ†å¸ƒå¼ç³»ç»Ÿå…±äº«æ•°æ®</strong>ã€‚</p><p>ç¼“å­˜æœ‰å‡ ç§å¸¸ç”¨ç±»å‹ï¼Œåˆ†åˆ«æ˜¯<strong>1. æœ¬åœ°ç¼“å­˜</strong>ï¼šJVMå†…å­˜ç¼“å­˜ï¼ˆå¦‚Caffeineã€Guavaï¼‰ï¼Œè®¿é—®å¿«ä½†æ˜¯ä»…é™å•æœºï¼›<strong>2. åˆ†å¸ƒå¼ç¼“å­˜</strong>ï¼šRedisã€Memcachedï¼Œé€‚åˆé›†ç¾¤ã€åˆ†å¸ƒå¼åœºæ™¯ï¼›<strong>3. æµè§ˆå™¨ç¼“å­˜</strong>ï¼šHTTP Cache-Controlï¼Œè®©å®¢æˆ·ç«¯ç¼“å­˜æ•°æ®ï¼Œå‡è½»æœåŠ¡å™¨å‹åŠ›</p><h4 id="ç¼“å­˜æ›´æ–°ç­–ç•¥"><a href="#ç¼“å­˜æ›´æ–°ç­–ç•¥" class="headerlink" title="ç¼“å­˜æ›´æ–°ç­–ç•¥"></a>ç¼“å­˜æ›´æ–°ç­–ç•¥</h4><ol><li><strong>å†…å­˜æ·˜æ±°LRU</strong>ï¼šRedisè‡ªå¸¦æœºåˆ¶ï¼Œå½“Rediså†…å­˜ä¸è¶³çš„æ—¶å€™ï¼Œæ ¹æ®ç­–ç•¥åˆ é™¤éƒ¨åˆ†keyï¼Œå¸¸ç”¨ç­–ç•¥æœ‰ï¼švolatile-lruï¼Œåªå¯¹è®¾ç½®äº†TTLçš„Keyè¿›è¡ŒLRUæ·˜æ±°ï¼›allkeys-lruï¼Œå¯¹æ‰€æœ‰Keyä½¿ç”¨LRUæ·˜æ±°ï¼›è¿˜æœ‰volatile-randomã€allkeys-randomã€volatile-ttl ç­‰</li><li><strong>è¿‡æœŸæ·˜æ±°</strong>ï¼šåˆ©ç”¨expireå‘½ä»¤ç»™æ•°æ®è®¾ç½®è¿‡æœŸæ—¶é—´</li><li><strong>ä¸»åŠ¨æ›´æ–°</strong>ï¼šä¸»åŠ¨å®Œæˆæ•°æ®åº“ä¸ç¼“å­˜çš„åŒæ—¶æ›´æ–°</li></ol><p>å¦‚ä½•é€‰æ‹©æ›´æ–°ç­–ç•¥ï¼Ÿæ ¹æ®ä¸€è‡´æ€§éœ€æ±‚ï¼Œä½ä¸€è‡´æ€§éœ€æ±‚ä¸‹ï¼Œé‡‡ç”¨å†…å­˜æ·˜æ±°æˆ–è¿‡æœŸæ·˜æ±°ï¼›é«˜ä¸€è‡´æ€§éœ€æ±‚ä¸‹ï¼Œé‡‡ç”¨ä¸»åŠ¨æ›´æ–°ä¸ºä¸»ï¼Œè¿‡æœŸæ·˜æ±°ä¸ºè¾…çš„ç­–ç•¥ã€‚</p><p>  <strong>ä¸»åŠ¨æ›´æ–°ç­–ç•¥</strong>ï¼š</p><ol><li>å†™æ—¶æ›´æ–° Write-Throughï¼šæ¯æ¬¡å†™æ•°æ®åº“ï¼ŒåŒæ—¶æ›´æ–°ç¼“å­˜ã€‚ç¼“å­˜ä¸æ•°æ®åº“é›†æˆä¸ºä¸€ä¸ªæœåŠ¡ï¼ŒæœåŠ¡ä¿è¯ä¸¤è€…çš„ä¸€è‡´æ€§ï¼Œå¯¹å¤–æš´éœ²APIæ¥å£ã€‚è°ƒç”¨è€…è°ƒç”¨APIï¼Œæ— éœ€çŸ¥é“è‡ªå·±æ“ä½œçš„æ˜¯æ•°æ®åº“è¿˜æ˜¯ç¼“å­˜ï¼Œä¸å…³å¿ƒä¸€è‡´æ€§ã€‚ä¼˜ç‚¹æ˜¯<strong>ä¸€è‡´æ€§ä¼˜ç§€</strong>ï¼Œä½†æ˜¯<strong>å®ç°å¤æ‚</strong>ï¼Œæ€§èƒ½ä¸€èˆ¬</li><li>å†™æ—¶å›å†™ Write-Backï¼šå…ˆæ›´æ–°ç¼“å­˜ï¼Œç„¶åå¼‚æ­¥å†™å…¥æ•°æ®åº“ã€‚ç¼“å­˜è°ƒç”¨è€…çš„CRUDéƒ½é’ˆå¯¹ç¼“å­˜å®Œæˆã€‚ç”±ç‹¬ç«‹çº¿ç¨‹å¼‚æ­¥çš„å°†ç¼“å­˜æ•°æ®å†™åˆ°æ•°æ®åº“ï¼Œå®ç°æœ€ç»ˆä¸€è‡´ã€‚ä¼˜ç‚¹æ˜¯<strong>æ€§èƒ½å¥½</strong>ï¼Œä½†<strong>ä¸€è‡´æ€§å·®</strong>ï¼Œå®ç°å¤æ‚</li><li>å»¶è¿ŸåŠ è½½ç¼“å­˜ Cache Asideï¼šç¼“å­˜ä¸å­˜åœ¨æˆ–è¿‡æœŸæ—¶ï¼Œæ‰ä»æ•°æ®åº“åŠ è½½å¹¶å†™å…¥ç¼“å­˜ï¼Œç¼“å­˜è°ƒç”¨è€…åœ¨æ›´æ–°æ•°æ®åº“çš„åŒæ—¶å®Œæˆå¯¹ç¼“å­˜çš„æ›´æ–°ã€‚ä¸€è‡´æ€§è‰¯å¥½ï¼Œå®ç°éš¾åº¦ä¸€èˆ¬</li></ol><p>ä¸‰ç§ç­–ç•¥çš„å¯¹æ¯”</p><table><thead><tr><th>ç‰¹æ€§</th><th>Cache Aside</th><th>Write-through</th><th>Write-behind</th></tr></thead><tbody><tr><td><strong>è¯»æ“ä½œ</strong></td><td>å…ˆæŸ¥ç¼“å­˜ï¼Œæœªå‘½ä¸­æŸ¥æ•°æ®åº“</td><td>ç›´æ¥è¯»ç¼“å­˜</td><td>ç›´æ¥è¯»ç¼“å­˜</td></tr><tr><td><strong>å†™æ“ä½œ</strong></td><td>å…ˆå†™æ•°æ®åº“ï¼Œæ›´æ–°&#x2F;åˆ é™¤ç¼“å­˜</td><td>å†™æ•°æ®åº“ + æ›´æ–°ç¼“å­˜</td><td>å†™ç¼“å­˜ â†’ å¼‚æ­¥å†™æ•°æ®åº“</td></tr><tr><td><strong>ä¸€è‡´æ€§</strong></td><td>æœ€ç»ˆä¸€è‡´</td><td>å¼ºä¸€è‡´</td><td>å¼±ä¸€è‡´</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>é¦–æ¬¡è®¿é—®æ…¢</td><td>å†™æ…¢ã€è¯»å¿«</td><td>å†™å¿«ã€è¯»å¿«</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>é«˜è¯»ä½å†™ã€çƒ­ç‚¹ä¸å›ºå®š</td><td>å†™å°‘ã€è¦æ±‚ä¸€è‡´æ€§</td><td>é«˜é¢‘å†™ã€å…è®¸çŸ­æš‚ä¸ä¸€è‡´</td></tr></tbody></table><p>  Cache Asideåœ¨å†™æ“ä½œæ—¶ï¼Œå¯¹ç¼“å­˜çš„æ“ä½œæœ‰ä¸¤ç§ï¼šä¸€æ˜¯æ›´æ–°ç¼“å­˜ï¼ŒäºŒæ˜¯åˆ é™¤ç¼“å­˜ï¼›å¯¹äº<strong>æ›´æ–°ç¼“å­˜</strong>ï¼Œå¯èƒ½å­˜åœ¨<strong>æ— æ•ˆæ›´æ–°</strong>å’Œè¾ƒå¤§çš„<strong>çº¿ç¨‹å®‰å…¨é—®é¢˜</strong>ï¼Œè€Œ<strong>åˆ é™¤ç¼“å­˜</strong>ï¼Œæœ¬è´¨ä¸Šæ˜¯<strong>å»¶è¿Ÿæ›´æ–°</strong>ï¼Œæ²¡æœ‰æ— æ•ˆæ›´æ–°ï¼Œçº¿ç¨‹å®‰å…¨é—®é¢˜ä¹Ÿè¾ƒä½ã€‚åœ¨å•ä½“ç³»ç»Ÿä¸­ï¼Œåˆ©ç”¨<strong>äº‹åŠ¡æœºåˆ¶</strong>ç¡®ä¿æ•°æ®åº“å’Œç¼“å­˜æ“ä½œçš„åŸå­æ€§ï¼›åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œåˆ©ç”¨åˆ†å¸ƒå¼äº‹åŠ¡æœºåˆ¶ä¿è¯åŸå­æ€§ã€‚</p><p>  æœ€ç»ˆå®ç°æœºåˆ¶ï¼š</p><ul><li>è¯»æ“ä½œæ—¶ï¼š1. å…ˆæŸ¥ç¼“å­˜ï¼Œå¦‚æœå‘½ä¸­ï¼Œç›´æ¥è¿”å›ï¼› 2. ç¼“å­˜æ²¡å‘½ä¸­ï¼ŒæŸ¥æ•°æ®åº“ï¼› 3. å°†æ•°æ®åº“æ•°æ®å†™å…¥ç¼“å­˜ï¼› 4. è¿”å›ç¼“å­˜ç»“æœ</li><li>å†™æ“ä½œæ—¶ï¼š1. å…ˆä¿®æ”¹æ•°æ®åº“ï¼›2. å†åˆ é™¤ç¼“å­˜  <strong>æ³¨æ„ç¡®ä¿ä¸¤æ­¥çš„åŸå­æ€§</strong></li></ul><h4 id="ä¸šåŠ¡é€»è¾‘"><a href="#ä¸šåŠ¡é€»è¾‘" class="headerlink" title="ä¸šåŠ¡é€»è¾‘"></a>ä¸šåŠ¡é€»è¾‘</h4><p><img src="/2025/08/20/Redis%E9%A1%B9%E7%9B%AE%E5%8F%8A%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/shopcache1.png" alt="redisç™»å½•æµç¨‹1" title="åŸºäºredisç™»å½•æµç¨‹1">  </p><h4 id="ç¼“å­˜ç©¿é€é—®é¢˜"><a href="#ç¼“å­˜ç©¿é€é—®é¢˜" class="headerlink" title="ç¼“å­˜ç©¿é€é—®é¢˜"></a>ç¼“å­˜ç©¿é€é—®é¢˜</h4><h4 id="ç¼“å­˜é›ªå´©é—®é¢˜"><a href="#ç¼“å­˜é›ªå´©é—®é¢˜" class="headerlink" title="ç¼“å­˜é›ªå´©é—®é¢˜"></a>ç¼“å­˜é›ªå´©é—®é¢˜</h4><h4 id="ç¼“å­˜å‡»ç©¿é—®é¢˜"><a href="#ç¼“å­˜å‡»ç©¿é—®é¢˜" class="headerlink" title="ç¼“å­˜å‡»ç©¿é—®é¢˜"></a>ç¼“å­˜å‡»ç©¿é—®é¢˜</h4><h2 id="Redisçš„åˆ†å¸ƒå¼"><a href="#Redisçš„åˆ†å¸ƒå¼" class="headerlink" title="Redisçš„åˆ†å¸ƒå¼"></a>Redisçš„åˆ†å¸ƒå¼</h2><h3 id="RedisæŒä¹…åŒ–"><a href="#RedisæŒä¹…åŒ–" class="headerlink" title="RedisæŒä¹…åŒ–"></a>RedisæŒä¹…åŒ–</h3><h4 id="RDB-Redis-Database-Backup-File"><a href="#RDB-Redis-Database-Backup-File" class="headerlink" title="RDB(Redis Database Backup File)"></a>RDB(Redis Database Backup File)</h4><p>Redisæ•°æ®å¤‡ä»½æ–‡ä»¶ï¼Œä¹Ÿå«Redisæ•°æ®å¿«ç…§ï¼Œå°±æ˜¯å°†å†…å­˜ä¸­çš„æ‰€æœ‰æ•°æ®éƒ½è®°å½•åˆ°ç£ç›˜ä¸­ã€‚å½“æ•…éšœåï¼Œä»ç£ç›˜è¯»å–å¿«ç…§æ–‡ä»¶ï¼Œæ¢å¤æ•°æ®ã€‚å¿«ç…§æ–‡ä»¶ç§°ä¸ºRDBæ–‡ä»¶ï¼Œé»˜è®¤ä¿å­˜åœ¨å½“å‰è¿è¡Œç›®å½•ã€‚  </p><ul><li>saveå‘½ä»¤ï¼šç”±Redisä¸»è¿›ç¨‹æ¥æ‰§è¡ŒRDBï¼Œä¼šé˜»å¡æ‰€æœ‰å‘½ä»¤  </li><li>bgsaveå‘½ä»¤ï¼šå¼€å¯å­è¿›ç¨‹æ‰§è¡ŒRDBï¼Œé¿å…ä¸»è¿›ç¨‹å—å½±å“</li></ul><p>Rediså†…éƒ¨å¯ä»¥è®¾ç½®è§¦å‘RDBçš„æœºåˆ¶ï¼Œåœ¨redis.confæ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ã€‚eg. save 5 1 è¡¨ç¤ºåœ¨5så†…ï¼Œå¦‚æœè‡³å°‘æœ‰1ä¸ªkeyè¢«ä¿®æ”¹å°±ä¼šæ‰§è¡Œä¸€æ¬¡bgsaveã€‚å…¶æ‰§è¡Œæµç¨‹ä¸ºï¼Œforkä¸»è¿›ç¨‹å¾—åˆ°ä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ‹·è´é¡µè¡¨ï¼Œå…±äº«å†…å­˜ç©ºé—´ï¼Œå­è¿›ç¨‹è¯»å–å†…å­˜å¹¶å†™å…¥æ–°çš„RDBæ–‡ä»¶ï¼Œç”¨æ–°çš„RDBæ–‡ä»¶æ›¿æ¢æ—§çš„RDBæ–‡ä»¶ã€‚</p><p>RDBç¼ºç‚¹ï¼š</p><ul><li>æ‰§è¡Œé—´éš”æ—¶é—´é•¿ï¼Œä¸¤æ¬¡RDBä¹‹é—´å†™å…¥æ•°æ®æœ‰ä¸¢å¤±çš„é£é™©ï¼›</li><li>forkå­è¿›ç¨‹ã€å‹ç¼©ã€å†™RDBæ–‡ä»¶éƒ½æ¯”è¾ƒè€—æ—¶ã€‚</li></ul><h4 id="AOF-Append-Only-File"><a href="#AOF-Append-Only-File" class="headerlink" title="AOF(Append Only File)"></a>AOF(Append Only File)</h4><p>Redisè¿½åŠ æ–‡ä»¶ï¼Œå°†Rediså¤„ç†çš„æ¯ä¸ªå†™å‘½ä»¤è®°å½•åœ¨AOPæ–‡ä»¶ï¼Œå¯ä»¥çœ‹ä½œå‘½ä»¤æ—¥å¿—æ–‡ä»¶ã€‚AOFé»˜è®¤æ˜¯å…³é—­çš„ï¼Œéœ€è¦ä¿®æ”¹redis.confé…ç½®æ–‡ä»¶æ¥å¼€å¯(appendonly yes)å’Œä¿®æ”¹å‘½ä»¤è®°å½•é¢‘ç‡(appendfsysnc always&#x2F;everysec&#x2F;no åˆ†åˆ«è¡¨ç¤ºlç«‹å³&#x2F;æ¯éš”1så°†&#x2F;ç”±æ“ä½œç³»ç»Ÿå†³å®šä½•æ—¶å°†ç¼“å­˜åŒºå†…å®¹å†™åˆ°aofæ–‡ä»¶)ã€‚</p><p>å› ä¸ºæ˜¯è®°å½•å‘½ä»¤ï¼Œæ‰€ä»¥AOFæ–‡ä»¶ä¼šå¾ˆå¤§ï¼Œå¹¶ä¸”å¤šæ¬¡å†™æ“ä½œåªæœ‰æœ€åä¸€æ¬¡æœ‰æ„ä¹‰ï¼Œå¯ä»¥é€šè¿‡bgrewriteaofå‘½ä»¤ï¼Œæ‰§è¡Œé‡å†™æ“ä½œï¼Œç”¨æœ€å°‘å‘½ä»¤è¾¾åˆ°ç›¸åŒæ•ˆæœã€‚åŒæ ·ä¿®æ”¹redis.confæ–‡ä»¶æ¥é…ç½®</p><h4 id="æŒä¹…åŒ–æ–¹æ¡ˆå¯¹æ¯”"><a href="#æŒä¹…åŒ–æ–¹æ¡ˆå¯¹æ¯”" class="headerlink" title="æŒä¹…åŒ–æ–¹æ¡ˆå¯¹æ¯”"></a>æŒä¹…åŒ–æ–¹æ¡ˆå¯¹æ¯”</h4><table><thead><tr><th></th><th><strong>RDB</strong></th><th><strong>AOF</strong></th></tr></thead><tbody><tr><td><strong>æŒä¹…åŒ–æ–¹å¼</strong></td><td>å®šæ—¶å¯¹æ•´ä¸ªå†…å­˜åšå¿«ç…§</td><td>è®°å½•æ¯ä¸€æ¬¡æ‰§è¡Œçš„å‘½ä»¤</td></tr><tr><td><strong>æ•°æ®å®Œæ•´æ€§</strong></td><td>ä¸¤æ¬¡å¤‡ä»½ä¹‹é—´çš„æ•°æ®ä¼šä¸¢å¤±</td><td>ç›¸å¯¹å®Œæ•´ï¼Œå–å†³äºåˆ·ç›˜ç­–ç•¥</td></tr><tr><td><strong>æ–‡ä»¶å¤§å°</strong></td><td>ä¼šæœ‰å‹ç¼©ï¼Œæ–‡ä»¶ä½“ç§¯å°</td><td>è®°å½•å‘½ä»¤ï¼Œæ–‡ä»¶ä½“ç§¯è¾ƒå¤§</td></tr><tr><td><strong>æ¢å¤é€Ÿåº¦</strong></td><td>å¾ˆå¿«</td><td>æ…¢ï¼Œè¦é‡æ–°æ‰§è¡Œå‘½ä»¤</td></tr><tr><td><strong>æ¢å¤ä¼˜å…ˆçº§</strong></td><td>ä½ï¼Œå› ä¸ºå®Œæ•´æ€§ä¸å¦‚AOF</td><td>é«˜ï¼Œå› ä¸ºæ•°æ®å®Œæ•´æ€§æ›´é«˜ï¼Œä¼˜å…ˆç”¨AOFæ¢å¤</td></tr><tr><td><strong>ç³»ç»Ÿèµ„æºå ç”¨</strong></td><td>é«˜ï¼Œå¤§é‡CPUå’Œèµ„æºæ¶ˆè€—</td><td>ä½ï¼Œä¸»è¦æ˜¯ç£ç›˜IOèµ„æºï¼Œä½†é‡å†™æ—¶ä¼šå ç”¨å¤§é‡CPUå’Œå†…å­˜èµ„æº</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>å¯ä»¥å®¹å¿æ•°åˆ†é’Ÿçš„æ•°æ®ä¸¢å¤±ï¼Œè¿½æ±‚æ›´å¿«çš„å¯åŠ¨é€Ÿåº¦</td><td>å¯¹æ•°æ®å®‰å…¨æ€§è¾ƒé«˜</td></tr></tbody></table><h3 id="Redisä¸»ä»é›†ç¾¤"><a href="#Redisä¸»ä»é›†ç¾¤" class="headerlink" title="Redisä¸»ä»é›†ç¾¤"></a>Redisä¸»ä»é›†ç¾¤</h3>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
